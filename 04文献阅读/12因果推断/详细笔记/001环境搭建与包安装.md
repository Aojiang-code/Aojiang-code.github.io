# 📓 阶段 0 学习笔记 —— 医学因果推断实践准备

## 0.1 环境搭建与包安装（扩展版）

在医学因果推断实践中，环境搭建的目标不仅是能运行代码，还要**保证包版本兼容、数据安全合规**，尤其是使用医疗数据（如MIMIC-IV）时，要避免因环境问题导致数据导入失败或模型不稳定。

### 一、所需 Python 库类别

#### 1. **数据处理与可视化**（基础工具）

* `pandas`：表格型数据处理（CSV、Excel、SQL查询结果、Parquet等）。
* `numpy`：底层数值计算库，很多机器学习和统计库的核心依赖。
* `matplotlib` & `seaborn`：可视化工具，前者偏底层、可定制性高，后者更适合快速绘制美观统计图。

#### 2. **统计与机器学习**（模型构建）

* `scikit-learn`：提供数据预处理（标准化、编码、划分训练测试集）、建模（回归、分类）、交叉验证等。
* `statsmodels`：专注于统计分析，支持线性/逻辑回归、广义线性模型（GLM）、Cox比例风险模型等——临床统计分析常用。

#### 3. **因果推断专用工具**（核心实践）

* `dowhy`：微软开源的因果推断框架，涵盖因果建模、估计、假设检验、敏感性分析。
* `econml`：微软开源，支持多种个体化治疗效应（CATE/ITE）估计方法，如T-learner、DR-learner、Orthogonal Forest等，适合精准医疗。
* `causalml`：Uber开源，侧重行业场景，内置倾向评分匹配、因果森林、Uplift建模等。

---

### 二、安装命令（推荐顺序）

> 💡 为避免版本冲突，建议先新建虚拟环境再安装。推荐 Python 版本 3.9\~3.10（`econml` 和 `causalml` 对高版本兼容性差）。

#### **Conda 环境（推荐）**

```bash
conda create -n causal python=3.10 -y
conda activate causal
pip install -U pip
pip install pandas numpy matplotlib seaborn scikit-learn statsmodels
pip install dowhy econml causalml
```

#### **venv 环境**

```bash
python -m venv causal-env
source causal-env/bin/activate  # Windows 使用: causal-env\Scripts\activate
pip install -U pip
pip install pandas numpy matplotlib seaborn scikit-learn statsmodels dowhy econml causalml
```

---

### 三、版本兼容建议（避免安装失败）

* **Windows** 用户安装 `econml` 和 `causalml` 时可能需要 C++ 编译工具（Visual Studio Build Tools）。
* **Mac M1/M2** 用户需确保安装 arm64 兼容版本，可考虑用 `conda-forge`。
* 如遇 `causalml` 安装失败，可先安装依赖：

  ```bash
  pip install lightgbm xgboost
  ```

  再安装：

  ```bash
  pip install causalml
  ```

---

### 四、安装验证（建议执行）

安装完成后，在 Python 终端或 Jupyter Notebook 中运行：

```python
import pandas, numpy, matplotlib, sklearn, statsmodels, dowhy, econml, causalml
print("环境配置成功！")
```

如果没有报错，就说明环境可用。

---

### 五、医学数据使用注意事项

* 对真实医疗数据（如MIMIC-IV、SEER），需提前签署数据使用协议，下载数据后建议放在加密磁盘中。
* 在处理敏感数据前，可先用 **内置数据集**（如DoWhy的Lalonde数据集）验证环境，确保后续分析顺畅。

---



配套代码:`001_Env_Check_and_Quickload.ipynb`
