# 📓 阶段 0 学习笔记 —— 医学因果推断实践准备 **概述**

## 🎯 阶段目标

* 完成因果推断分析的**技术环境搭建**
* 熟悉 Python 中与**数据处理、可视化、统计分析、因果推断**相关的核心工具
* 掌握**数据加载、基本探索、因果 EDA**的流程
* 为后续的因果推断估计与验证打好坚实基础

---

## 0.1 环境搭建与包安装

* **核心类别**

  1. 数据处理与可视化：`pandas`、`numpy`、`matplotlib`、`seaborn`
  2. 统计与机器学习：`scikit-learn`、`statsmodels`
  3. 因果推断工具：`dowhy`（因果图+ATE+敏感性分析）、`econml`（CATE/ITE）、`causalml`（倾向评分+因果森林等）

* **安装建议**

  * 使用 Conda/venv 创建虚拟环境，推荐 Python 3.9\~3.10
  * 注意 Windows/Mac M1/M2 上 `econml`、`causalml` 的编译依赖
  * 安装完成后，运行简单导入测试，确保包版本可用

* **配套 Notebook**

  * 环境自检脚本（包版本检查）
  * 内置数据集快速加载

---

## 0.2 Python 必备工具回顾（实战版）

* 使用 **乳腺癌（Breast Cancer）** 与 **糖尿病进展（Diabetes）** 两个 `sklearn` 内置医学数据集，复习：

  * **pandas**：读取数据、查看结构、缺失检查、筛选、分组统计、交叉表
  * **可视化**：直方图、箱线图、相关性热图
  * **因果视角提醒**：EDA 只能揭示**关联与分布**，不能直接得出因果结论；要在后续建模中明确暴露-结局-混杂

* **配套 Notebook**

  * 数据导入 + 常见 EDA + 可视化
  * 适合快速熟悉语法与可视化技巧

---

## 0.3 数据加载与探索

* **DoWhy 内置 Lalonde 数据集**

  * 变量角色：`treatment`（暴露）、`y`（结局）、`v0-v4`（混杂）、`z0`（工具变量）
  * 基线平衡检查（SMD 表）、直方图可视化、倾向评分初步重叠检查

* **公共医学数据集**

  * **UCI Heart Disease**：心血管病例/对照结构，适合 EDA 与流程演练
  * **MIMIC-IV**：真实 ICU 病人 RWD，适合构建干预-结局分析框架
  * **SEER**：癌症注册，适合生存分析与分层研究
  * 各数据集的**获取途径、数据结构特点、因果分析注意事项**

* **配套 Notebook**

  * Lalonde 因果 EDA（平衡表+PS重叠）
  * UCI Heart 数据加载与通用 EDA 工具函数

---

## 0.4 医学数据探索要点（EDA for Causal Inference）

* **EDA 目标转向因果分析**：

  1. 确认**时间顺序**（治疗在前，结局在后，协变量取自治疗前）
  2. 识别并处理**混杂、中介、碰撞**
  3. 检查**缺失模式**（MCAR/MAR/MNAR）
  4. 基线平衡（SMD 表 + Love plot）
  5. 倾向评分重叠（Positivity/Overlap）
  6. 分布与尺度调整（标准化、对数变换、异常值处理）
  7. 共线性检查（相关矩阵、VIF）
  8. 生存数据特有 EDA（删失、竞争风险、随访起点对齐）

* **一键模板函数**

  * `causal_eda_quickcheck(df, treat, outcome, pre_covs)`：一次性完成缺失检查、SMD、PS重叠图等
  * 可复用在任何数据集

* **配套 Notebook**

  * 因果 EDA 检查清单
  * 模板函数 + 演示数据运行示例

---

## 阶段 0 完成后的能力

* 独立搭建医学因果推断的 Python 环境
* 熟练使用 pandas / matplotlib / seaborn 进行数据探索与可视化
* 能加载并初步分析内置与公共医学数据集
* 掌握因果分析特有的 EDA 要点（时间顺序、变量角色、平衡性、重叠性）
* 会用工具函数和 Notebook 快速完成数据检查

---


