# ğŸ““ é˜¶æ®µ 0 å­¦ä¹ ç¬”è®° â€”â€” åŒ»å­¦å› æœæ¨æ–­å®è·µå‡†å¤‡

## 0.1 ç¯å¢ƒæ­å»ºä¸åŒ…å®‰è£…

åœ¨å› æœæ¨æ–­å®è·µä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°ä¸‰ç±» Python åº“ï¼š

1. **æ•°æ®å¤„ç†ä¸å¯è§†åŒ–**

   * `pandas`ï¼šæ•°æ®è¡¨æ ¼å¤„ç†
   * `numpy`ï¼šæ•°å€¼è®¡ç®—
   * `matplotlib` & `seaborn`ï¼šæ•°æ®å¯è§†åŒ–

2. **ç»Ÿè®¡ä¸æœºå™¨å­¦ä¹ **

   * `scikit-learn`ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹ä¸æ•°æ®é¢„å¤„ç†
   * `statsmodels`ï¼šç»Ÿè®¡å»ºæ¨¡ï¼ˆå¦‚é€»è¾‘å›å½’ã€Cox å›å½’ï¼‰

3. **å› æœæ¨æ–­ä¸“ç”¨å·¥å…·**

   * `dowhy`ï¼šå¾®è½¯å¼€æºçš„å› æœæ¨æ–­æ¡†æ¶ï¼Œæ”¯æŒå› æœå›¾ã€ATEä¼°è®¡ã€æ•æ„Ÿæ€§åˆ†æ
   * `econml`ï¼šå¾®è½¯å¼€æºï¼Œæ”¯æŒä¸ªä½“åŒ–æ²»ç–—æ•ˆæœä¼°è®¡ï¼ˆCATE/ITEï¼‰
   * `causalml`ï¼šUber å¼€æºï¼Œé€‚åˆåšå€¾å‘è¯„åˆ†åŒ¹é…ã€å› æœæ£®æ—ç­‰

**å®‰è£…å‘½ä»¤ï¼š**

```bash
pip install pandas numpy matplotlib seaborn scikit-learn statsmodels dowhy econml causalml
```

> ğŸ’¡ å»ºè®®åœ¨è™šæ‹Ÿç¯å¢ƒï¼ˆconda æˆ– venvï¼‰ä¸­å®‰è£…ï¼Œä»¥å…å’Œå…¶ä»–é¡¹ç›®å†²çª
>
> ```bash
> conda create -n causal python=3.10
> conda activate causal
> pip install ...
> ```

---

## 0.2 Python å¿…å¤‡å·¥å…·å›é¡¾ï¼ˆå¿«é€Ÿå¤ä¹ ï¼‰

å›é¡¾python åŸºç¡€ï¼Œè¿™é‡Œæä¾›ä¸€äº› Python åŸºç¡€çŸ¥è¯†ï¼Œä½ å¯ä»¥å¿«é€Ÿå¤ä¹ ã€‚

### 0.2.1 `pandas` æ•°æ®æ“ä½œ

```python
import pandas as pd

# è¯»å– CSV æ–‡ä»¶
df = pd.read_csv("data.csv")

# æŸ¥çœ‹å‰å‡ è¡Œ
print(df.head())

# æŸ¥çœ‹æ•°æ®ç±»å‹å’Œç¼ºå¤±å€¼
print(df.info())

# ç­›é€‰ï¼šé€‰æ‹©ç³–å°¿ç—…æ‚£è€…
df_diabetes = df[df['diabetes'] == 1]

# ç»Ÿè®¡ï¼šæ¯ç§æ€§åˆ«çš„å¹³å‡å¹´é¾„
print(df.groupby('sex')['age'].mean())
```

---

### 0.2.2 å¯è§†åŒ–

```python
import matplotlib.pyplot as plt
import seaborn as sns

# ç›´æ–¹å›¾ï¼šå¹´é¾„åˆ†å¸ƒ
sns.histplot(df['age'], kde=True)
plt.show()

# ç®±çº¿å›¾ï¼šä¸åŒæ²»ç–—ç»„çš„è¡€å‹åˆ†å¸ƒ
sns.boxplot(x='treatment', y='blood_pressure', data=df)
plt.show()
```

---

## 0.3 æ•°æ®åŠ è½½ä¸æ¢ç´¢

åœ¨é˜¶æ®µ 0ï¼Œæˆ‘ä»¬ä¼šå…ˆç”¨ **å†…ç½®æ•°æ®é›†** ç»ƒæ‰‹ï¼Œç„¶åå­¦ä¼šåŠ è½½**åŒ»å­¦å…¬å…±æ•°æ®é›†**ã€‚

---

### 0.3.1 ä½¿ç”¨ DoWhy å†…ç½® Lalonde æ•°æ®é›†

è¿™ä¸ªæ•°æ®é›†æ˜¯å› æœæ¨æ–­é¢†åŸŸçš„ç»å…¸æ•™å­¦æ¡ˆä¾‹ï¼Œæ¨¡æ‹Ÿäº†**èŒä¸šåŸ¹è®­å¯¹æ”¶å…¥çš„å› æœå½±å“**ï¼Œå’Œä¸´åºŠè¯•éªŒçš„ç»“æ„ç±»ä¼¼ï¼ˆæœ‰æ²»ç–—ç»„å’Œå¯¹ç…§ç»„ï¼‰ã€‚

```python
import dowhy.datasets

# åŠ è½½æ•°æ®
data = dowhy.datasets.linear_dataset(
    beta=10,  # å¤„ç†æ•ˆåº”å¤§å°
    num_common_causes=5,  # æ··æ‚å˜é‡ä¸ªæ•°
    num_instruments=1,    # å·¥å…·å˜é‡ä¸ªæ•°
    num_samples=1000, 
    treatment_is_binary=True
)

df = data["df"]
print(df.head())
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
   v0        v1    v2    v3    v4  z0  treatment     y
0  0.5  1.232  -0.3  0.77  1.20  0.2         1  15.32
...
```

è¿™é‡Œï¼š

* `treatment`ï¼šæ˜¯å¦æ¥å—å¹²é¢„ï¼ˆå¦‚æ˜¯å¦æœè¯ï¼‰
* `y`ï¼šç»“æœå˜é‡ï¼ˆå¦‚æ”¶å…¥ã€è¡€å‹å˜åŒ–ï¼‰
* `v0`-`v4`ï¼šæ··æ‚å˜é‡
* `z0`ï¼šå·¥å…·å˜é‡

---

### 0.3.2 è·å–å…è´¹åŒ»å­¦æ•°æ®é›†

#### **(1) UCI Heart Disease æ•°æ®é›†**

* **ç”¨é€”**ï¼šå¯ç”¨äºè¯„ä¼°æ²»ç–—ï¼ˆå¦‚è¯ç‰©ã€æ‰‹æœ¯ï¼‰å¯¹å¿ƒè„ç—…é£é™©çš„å› æœå½±å“
* **ä¸‹è½½é“¾æ¥**ï¼š[UCI Heart Disease](https://archive.ics.uci.edu/ml/datasets/heart+Disease)
* **åŠ è½½ç¤ºä¾‹**ï¼š

```python
url = "https://raw.githubusercontent.com/selva86/datasets/master/Heart.csv"
df = pd.read_csv(url)
print(df.head())
```

---

#### **(2) MIMIC-IVï¼ˆé‡ç—‡ç›‘æŠ¤ç—…äººæ•°æ®ï¼‰**

* **ç”¨é€”**ï¼šçœŸå® ICU ç—…äººè®°å½•ï¼Œå¯è¯„ä¼°å¹²é¢„ï¼ˆè¯ç‰©ã€æ‰‹æœ¯ï¼‰å¯¹ç”Ÿå­˜ç‡å½±å“
* **è·å–æ–¹å¼**ï¼š

  * éœ€åœ¨ [PhysioNet](https://physionet.org/content/mimiciv/2.2/) æ³¨å†Œå¹¶é€šè¿‡æ•°æ®ä½¿ç”¨åè®®
  * ä¸‹è½½åç”¨ `pandas.read_csv()` åŠ è½½
* **åŠ è½½ç¤ºä¾‹**ï¼š

```python
df = pd.read_csv("mimiciv_subset.csv")  # è‡ªå·±ä¸‹è½½çš„å­é›†
print(df.describe())
```

---

#### **(3) SEER ç™Œç—‡æ³¨å†Œæ•°æ®**

* **ç”¨é€”**ï¼šåšç™Œç—‡æ²»ç–—æ•ˆæœä¸ç”Ÿå­˜åˆ†æ
* **è·å–æ–¹å¼**ï¼šéœ€åœ¨ [SEER](https://seer.cancer.gov/data/) ç”³è¯·è®¿é—®
* **æ³¨æ„**ï¼šæ•°æ®ä½“é‡å¤§ï¼Œå»ºè®®æå–éƒ¨åˆ†å­—æ®µåšå› æœæ¨æ–­ç»ƒä¹ 

---

## 0.4 åŒ»å­¦æ•°æ®æ¢ç´¢è¦ç‚¹ï¼ˆEDA for Causal Inferenceï¼‰

åœ¨å› æœæ¨æ–­ä¸­ï¼ŒEDA é‡ç‚¹ä¸æ˜¯é¢„æµ‹ç²¾åº¦ï¼Œè€Œæ˜¯**å‘ç°æ··æ‚å› å­ã€åå€šã€å˜é‡åˆ†å¸ƒ**ã€‚

```python
# æŸ¥çœ‹æ•°æ®è§„æ¨¡
print(df.shape)

# æ£€æŸ¥ç¼ºå¤±å€¼
print(df.isnull().sum())

# æ£€æŸ¥æ²»ç–—ç»„ vs å¯¹ç…§ç»„å·®å¼‚
sns.boxplot(x='treatment', y='age', data=df)
plt.show()

# äº¤å‰è¡¨ï¼ˆæ²»ç–— vs æ€§åˆ«ï¼‰
print(pd.crosstab(df['treatment'], df['sex']))
```

**EDA é‡ç‚¹ï¼š**

1. **æ²»ç–—ç»„å’Œå¯¹ç…§ç»„åŸºçº¿å·®å¼‚** â†’ æ˜¯å¦å­˜åœ¨æ˜æ˜¾æ··æ‚
2. **å˜é‡åˆ†å¸ƒ** â†’ æ˜¯å¦éœ€è¦æ ‡å‡†åŒ–ã€è½¬æ¢
3. **ç¼ºå¤±æ•°æ®æ¨¡å¼** â†’ æ˜¯å¦éšæœºç¼ºå¤±ï¼ˆMCARï¼‰ã€æ˜¯å¦éœ€å¡«è¡¥

---

## é˜¶æ®µ 0 æ€»ç»“

åˆ°é˜¶æ®µ 0 ç»“æŸæ—¶ï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

* æ­å»º Python ç¯å¢ƒå¹¶å®‰è£…å› æœæ¨æ–­ç›¸å…³åŒ…
* ç†Ÿæ‚‰æ•°æ®è¯»å–ã€æ¸…æ´—ã€åŸºæœ¬å¯è§†åŒ–
* èƒ½åŠ è½½è‡³å°‘ 1 ä¸ªåŒ»å­¦æ•°æ®é›†ï¼ˆå¦‚ UCI Heart Diseaseï¼‰
* å¯¹æ•°æ®è¿›è¡Œå› æœæ¨æ–­å‰çš„åˆæ­¥æ¢ç´¢ï¼ˆEDAï¼‰

---


