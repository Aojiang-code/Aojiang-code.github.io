下面是**第1章：研究合规与数据伦理**的详细学习笔记。内容面向你后续在 VSCode + Jupyter + DuckDB + CSV 的研究流程，强调“拿到数据前要做什么、拿到数据后怎么做得安全合规”。

---

# 第1章 研究合规与数据伦理

## 1.1 访问资质与合规：PhysioNet / CITI / 数据使用协议（DUA）

### 1.1.1 你需要完成的三件事（顺序建议）

1. **完成 CITI 培训**

   * 推荐课程：CITI Program 的 **“Data or Specimens Only Research”**。注册时选择机构 **“Massachusetts Institute of Technology Affiliates”** 进行关联，并完成“Conflicts of Interest”模块。提交给 PhysioNet 时请上传 **Training Report（完成报告）** 而非证书。([PhysioNet][1])
2. **申请 PhysioNet 的 Credentialed Access（受限访问）**

   * 在 MIMIC-IV 项目页提交申请：需要**受训证明 + 签署数据使用协议（DUA）**。([PhysioNet][2])
3. **签署并遵守 PhysioNet Credentialed Health Data Use Agreement（DUA）**

   * 关键义务包括：不尝试再识别；**不得与他人共享你的访问权限**；**妥善保护数据安全**；如公开研究结果，**需要同时开源用于产生结果的代码**；若发现潜在可识别信息，需邮件报告。([PhysioNet][3])

> 快速上手替代方案：在资质审批期间，可先用 **MIMIC-IV Demo（100名患者）** 进行流程演练（Demo 为开放获取、无临床笔记）。([PhysioNet][4])

### 1.1.2 组织协作与权限

* **每位成员**都需单独完成 CITI 与 DUA；不得把数据转发给**未获授权**的成员（含外包与实习）。([PhysioNet][3])
* 不得将受限数据上传至**第三方在线服务或开放平台**（例如通用大模型 API、公开云端笔记本、共享网盘的公共链接等）。针对大模型特别强调：**禁止把 Credentialed 数据发给在线 GPT/LLM 服务**。([PhysioNet][5])

### 1.1.3 代码与论文合规发布

* 发表论文或公开报告时：**公开用于产生结果的代码与处理脚本**，但**不可发布或再分发数据本身**。代码托管建议：GitHub（含 `README` 的合规说明与复现实验脚本）。([PhysioNet][3])

---

## 1.2 去标识化与时间偏移的影响（如何正确理解 MIMIC 的“时间”）

### 1.2.1 MIMIC 的去标识化做法（理解数据特性）

* MIMIC-IV 在发布前：依据 HIPAA 进行了去标识化（移除标识符、为患者/住院/ICU 分配新整数ID、必要时清理自由文本），并**对日期时间进行了“向未来的偏移（per-subject offset）”**。**同一患者内部的时间间隔被严格保持**，但**不同患者之间的绝对年份不可比较**。([PhysioNet][2])
* `core.patients` 中的 **`anchor_year`（取值 2100–2200）与 `anchor_year_group`（真实年份所在的 3 年区间）**用于提供**粗略年代线索**；对**年龄>89岁**的患者，年龄被处理为统一值（例如 91）。([PhysioNet][2])

> 研究启示
>
> * **可以**做：单个患者内的时间序列建模、如“入科后 24h”之类的**相对时间窗口**分析。
> * **谨慎/避免**：跨患者的**绝对时间**比较（例如“2012 年 vs 2013 年的季节性”）。如需日历季节特征，应使用衍生字段（如 `anchor_year_group`）进行**近似**并在论文中声明局限。

### 1.2.2 HIPAA 去标识化两条路径（理解法规背景）

* **两种方法**：**专家判定（Expert Determination）** 或 **安全港（Safe Harbor）**。安全港要求移除一系列标识符（例如：姓名、详细地理信息、**与个人直接相关的所有日期的“具体月日（仅保留年）”**、电话/邮箱/账号/车牌/设备ID/URL/IP、生物特征、全脸照等），并且**年龄>89**需合并为1个类别。([HHS.gov][6])

> 研究启示
>
> * **不要反推或联动外部数据**试图恢复真实时间或身份。
> * 如在自由文本或罕见字段中发现疑似可识别信息，应按 DUA 要求**邮件上报**。([PhysioNet][3])

---

## 1.3 隐私保护与可重复研究声明（README/许可/排除临床用途）

以下模板可放入你项目仓库的 `README.md` 顶部（随后每个 Notebook 也在首格 MarkDown 中重复简述）：

> **研究用途声明（模板）**
> 本项目使用的 MIMIC 数据为去标识化后的受限健康数据，仅用于**合法的科学研究**与教学目的。项目**不用于临床诊断或治疗决策**，也不构成医疗建议。任何实验结果仅为研究结论，**不得直接用于患者护理**。
> 项目组成员均已完成 **CITI “Data or Specimens Only Research”** 培训并获得 **PhysioNet Credentialed Access**，且已签署并遵守 **PhysioNet Credentialed Health Data Use Agreement（DUA）**。我们将**公开用于产生结果的代码**，但不会以任何形式再分发受限数据或其可逆恢复的派生物。([PhysioNet][1])

### 1.3.1 数据治理与安全实践（适用于 DuckDB + CSV 工作流）

* **数据落盘与分区**

  * `/data/raw/`（只读、原始 CSV）；`/data/interim/`（清洗中间件，如 Parquet）；`/data/derived/`（特征矩阵、模型中间结果）。
  * 将 `/data/**` **加入 .gitignore**；仓库只追踪**代码与配置**，**不追踪数据**。
* **权限与访问控制**

  * 受限数据仅保存在**受控主机/磁盘**（加密卷/文件系统），关闭公共入口；VPN + 防火墙白名单；最小权限原则。
  * **不得上传到第三方在线服务或大模型 API**（包括把原始 CSV、片段或可还原的明细记录粘贴到在线工具）。([PhysioNet][5])
* **处理与缓存**（DuckDB 视角）

  * 尽量以**只读映射 CSV → DuckDB** 的方式操作；将中间表写入 **Parquet（列存、可压缩、可校验）**。
  * 导出示例数据时，仅保留**匿名、聚合或合规的样例**（如 100–1000 行的**衍生特征矩阵**，而非原始明细）。
* **日志与临时文件**

  * Jupyter 的 `.ipynb_checkpoints/`、系统临时目录中可能缓存数据片段，定期清理；关闭或重定向含数据的 debug 日志。
* **对外发布**

  * 开源许可仅覆盖**代码**与**文档**；受限数据不在许可范围内。提交论文时**附上代码仓库**和**运行说明**以满足 DUA 的“公开代码”要求。([PhysioNet][3])

### 1.3.2 复现性与可追溯（Reproducibility）

* **配置化**：将路径、时间窗、过滤条件等写入 `config.yaml`；Notebook 读取配置并记录到输出目录。
* **结果可核验**：每次运行写入 `manifest.json`（含数据版本、MIMIC 版本号、代码提交哈希、时间戳、参数快照）。
* **数据不可公开**：若需共享可复现实验，应使用 **PhysioNet 上的受控共享**（如把衍生资源作为 Ext 数据集提交回 PhysioNet，沿用相同 DUA）。([PhysioNet][2])

---

## 实操清单（本章完成度自检）

* [ ] 我已完成 CITI “Data or Specimens Only Research” 课程并取得 **Training Report**。([PhysioNet][1])
* [ ] 我在 PhysioNet 上完成 **Credentialed Access** 审批，并在 MIMIC-IV 项目页**签署 DUA**。([PhysioNet][2])
* [ ] 我理解并接受 DUA 的义务：**不共享、保密防护、公开代码、发现疑似 PHI 需报告**。([PhysioNet][3])
* [ ] 我不会把受限数据发给任意**第三方在线服务/LLM API**（含 GPT 等）。([PhysioNet][5])
* [ ] 我理解 MIMIC 的**时间偏移**与 `anchor_year(_group)` 语义，避免跨患者绝对年份比较。([PhysioNet][2])
* [ ] 仓库 `README` 已加入**研究用途声明**、**数据不入库**、**仅开源代码**、**不可用于临床**等条款。

---

> 到这里，第1章就绪。
> 如果你满意，我们就进入**第2章：开发环境搭建（VSCode + Jupyter + DuckDB + CSV）**，并给出一套“**零 SQL**、数据帧工作流”的可执行 Notebook 骨架与项目目录。你也可以先指定某一小节，我直接写成可用的笔记 + Notebook 模板。

[1]: https://physionet.org/about/citi-course/ "CITI Course Instructions"
[2]: https://physionet.org/content/mimiciv/1.0/ "MIMIC-IV v1.0"
[3]: https://physionet.org/content/mimiciii/view-dua/1.4/ "
License for MIMIC-III Clinical Database v1.4
"
[4]: https://physionet.org/content/mimic-iv-demo/?utm_source=chatgpt.com "MIMIC-IV Clinical Database Demo v2.2"
[5]: https://physionet.org/news/post/gpt-responsible-use "Responsible use of MIMIC data with online services like GPT"
[6]: https://www.hhs.gov/hipaa/for-professionals/special-topics/de-identification/index.html "Methods for De-identification of PHI | HHS.gov"
