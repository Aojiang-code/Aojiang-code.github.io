# 儿童重症监护中早期预测急性肾损伤（AKI）的机器学习模型

## 基本信息
- 标题：Machine learning model for early prediction of acute kidney injury (AKI) in pediatric critical care
- 分区：
- 期刊：Critical Care
- 发表时间：2021年
- 阅读时间：2024年1月
- 关键词：Acute kidney injury, AKI, Pediatric critical care, Machine learning, Predictive model
- 作者：Junzi Dong1* , Ting Feng1, Binod Thapa‑Chhetry1, Byung Gu Cho1
- 国家：美国
- 方法：
- 创新点：
- 不足之处：
- 可借鉴之处：
- DOI:https://doi.org/10.1186/s13054-021-03724-0


## [ChatPaper](https://chatpaper.org/)分析结果

### Basic Information:
- Title: Machine learning model for early prediction of acute kidney injury (AKI) in pediatric critical care (机器学习模型用于儿科重症监护中早期预测急性肾损伤)
- Authors: Junzi Dong, Ting Feng, Binod Thapa-Chhetry, Byung Gu Cho, Tunu Shum, David P. Inwald, Christopher J. L. Newth, Vinay U. Vaidya
- Affiliation: Connected Care and Personal Health Team, Philips Research North America, 222 Jacobs Street, Cambridge, MA 02141, USA (美国飞利浦研究北美公司)
- Keywords: Acute kidney injury, AKI, Pediatric critical care, Machine learning, Predictive model
- URLs: [Paper](https://doi.org/10.1186/s13054-021-03724-0), [GitHub: None]
### 论文简要 :
本研究开发了一个机器学习模型，通过学习生理测量的预病模式，能够在儿科重症监护中提前48小时预测急性肾损伤（AKI），以及提供相关信息和建议的预警，有望通过早期干预措施改善儿科AKI的预后。
### 背景信息:
#### 论文背景: 
儿科重症监护患者中有四分之一会发生急性肾损伤（AKI），这与更高的死亡率、更长的住院时间和随后发展为慢性肾脏疾病有关。目前，AKI的诊断依赖于血清肌酐和尿量，但肾功能损伤通常在肌酐升高之前发生，因此目前的诊断指南只能在肾损伤或功能障碍已经出现后检测到AKI。早期预测AKI对于识别患者的风险并及早干预以改善预后非常重要。
#### 过去方案: 
目前已有许多研究团队利用电子健康记录（EHR）数据进行AKI的早期预测，但迄今为止没有一个模型能够解释特定预测的原因，尽管明确需要可解释和可操作的预测。在儿科患者中，由于生理特点随年龄差异较大，开发一个能够学习儿科早期AKI的年龄适宜特征的预测模型仍然是一个额外的挑战。
#### 论文的Motivation: 
本研究旨在开发一个能够实时运行的儿科AKI预测模型，能够检测患者生理学的微小变化并提醒护理人员高风险的AKI患者，并提供可解释的背景信息和建议措施。主要目标是在AKI发生前的6到48小时内预测中度到重度AKI的发生。此外，该模型还对包括任何AKI（1/2/3期）的发生和需要肾脏替代治疗（RRT）的预测进行了评估。据我们所知，这是第一个能够解释每个预测的AKI预测模型，并且是儿科重症监护AKI预测的第一个经过多中心验证的模型。
### 方法:
#### a. 理论背景:

本研究开发了一个机器学习模型，可以在儿科重症监护患者中提前48小时预测急性肾损伤（AKI），比目前已建立的诊断指南更早。该模型使用生理测量和智能工程预测因子来评估实时的AKI风险，并生成警报以便快速评估和降低AKI风险。
#### b. 技术路线:

本研究使用来自16,863名儿科重症监护患者的电子健康记录（EHR）数据，开发了一个机器学习模型，用于早期预测AKI。数据被分为推导、验证和保留测试数据集。该模型使用智能工程预测因子（如肌酐变化率）进行训练，并在保留测试数据上进行验证。主要结果是在发生中度到重度AKI之前，能够预测其发生的6到48小时。
### 结果:
#### a. 详细的实验设置:

该机器学习模型成功地在常规标准检测之前预测了2/3期AKI，中位提前时间为30小时。该模型还预测了相当比例的肾脏替代治疗（RRT）和任何AKI发作。在预测的患者中，有很高比例的患者在被模型识别出来后但在发生AKI之前接受了潜在的肾毒性药物。
#### b. 详细的实验结果:

本研究中描述的机器学习模型能够准确预测中度到重度AKI的发生，提前48小时。通过提供早期警报和可操作的反馈，它可能通过实施早期措施（如药物调整）来改善结果，从而预防或减少AKI的发生。这是首个为所有儿科重症监护患者验证的多中心AKI预测模型。

### 讨论(方法、创新点、不足之处)
#### 方法：

研究人群：该研究包括来自三个独立的三级儿科重症监护中心的PICU和心胸外科重症监护病房（CTICU）的患者。数据集来自美国医院（Hospital 1）的2003年至2011年、英国医院（Hospital 2）的2009年至2015年和美国医院（Hospital 3）的2014年至2019年。研究数据已去标识化，并且根据声明中的规定免除了知情同意。
数据提取和验证：每个中心的患者数据被分为推导（70%）、验证（15%）和保留测试（15%）数据集，没有患者重叠。使用推导和验证数据从所有医院设计和训练了一个单一的预测模型，然后在每个医院的保留测试数据上进行验证。
研究结果：训练模型能够在AKI发生前48到6小时的时间范围内预测2/3期AKI。模型还可以预测任何AKI（1/2/3期）和需要RRT的情况。
#### 创新点：

该模型使用了包括生命体征、实验室值、药物历史和通气参数在内的四种类型的数据元素作为预测因子。
模型考虑了年龄相关的风险，使其适用于广泛的患者年龄范围。
模型的预测风险是所有弱分类器预测的总和，可以分离和排名每个非年龄预测因子对每个预测的贡献，从而使AKI风险预测对用户透明和可解释。
#### 不足之处：

该模型仅使用肌酐来分期AKI，可能导致AKI率较低。
模型的泛化能力尚未完全解决，需要在更大的非美国数据集上进行更多的验证工作。
如何将模型呈现和整合到工作流程中的最佳方式尚未经过测试。
模型对入院原因和患者合并症的性能未知。
可借鉴之处：

该模型提供了一个预测工具，可以在AKI发生前48小时内对PICU患者进行预测，为临床干预提供了关键的时间窗口。
模型能够提供与患者测量值相关的信息，为临床医生提供潜在的可操作建议。
该模型在多个独立的PICU上进行了训练和验证，具有较强的预测性能。


### Note:
本总结源自于LLM的总结，请注意数据判别. Power by ChatPaper. End.



## Abstract
### Background:
儿科重症监护患者的急性肾损伤（AKI）是通过血清肌酐升高来诊断的，这种升高仅发生在肾损伤后。

一旦AKI发展起来，除了支持性护理之外，没有其他治疗方法，因此识别有风险的患者以防止受伤很重要。

这项研究开发了一个机器学习模型，以学习疾病前的生理测量模式，并比目前制定的诊断指南提前48小时预测儿科AKI。

### Methods:
来自三个独立机构的16863名1个月至21岁的儿科重症监护患者的EHR数据用于开发一个单机学习模型，用于使用智能设计的预测因子（如肌酸酐变化率）早期预测基于肌酸酐的AKI，以自动评估实时AKI风险。

主要结果是预测中度至重度AKI（2/3期），次要结果是预测任何AKI（1/2/3期）和需要肾脏替代治疗（RRT）。

预测生成警报，允许快速评估和降低AKI风险，例如：“患者在未来48小时内发生AKI的风险为90%”，以及上下文信息和建议的反应，例如“患者服用氨基糖苷类药物，建议检查水平并审查剂量和指征”。

### Results: 
该模型成功地预测了传统标准检测前的2/3期AKI，AUROC为0.89时的中位提前期为30小时。

该模型预测了70%的后续RRT发作、58%的2/3期发作和41%的任何AKI发作。

任何AKI发作的假警报与真警报的比例约为1:1（PPV 47%）。

在预测的患者中，79%的患者在模型确定后但在AKI发展之前接受了潜在的肾毒性药物治疗。
### Conclusions:
作为第一个针对所有儿科重症监护患者的多中心验证的AKI预测模型，本研究中描述的机器学习模型在AKI发作前48小时准确预测了中度至重度AKI。

该模型可以通过提供早期警报和可操作的反馈来改善儿科AKI的结果，并可能通过实施早期措施（如药物调整）来预防或减少AKI。

### Keywords:
Acute kidney injury, AKI, Pediatric critical care, Machine learning, Predictive model
急性肾损伤，AKI，儿科重症监护，机器学习，预测模型







## Background
AKI影响多达四分之一的儿科重症监护患者[1]，并与更高的死亡率、更长的住院时间和随后的慢性肾脏疾病发展独立相关[2-4]。目前，AKI是根据血清肌酐和尿量[5]，使用肾脏疾病改善全球门诊（KDIGO）临床实践指南进行诊断。

**然而**，由于肾损伤通常先于肌酐增加，分期指南仅在肾损伤或损伤已经开始后检测AKI。虽然在儿科重症监护室（PICU）中，在AKI发展后通常没有特定的治疗方法来逆转[6]，一些研究表明，AKI后肾功能的早期改善可能会带来更好的结果[1，5，7]。

**因此**，AKI的早期预测对于识别有发展为AKI风险的患者和早期干预以改善结果非常重要。

**虽然**AKI在PICU患者中是多因素的，但它最常见于低血压引起的一段时间的肾低灌注之后。可能改善肾功能的简单干预措施包括确保用血管内填充物或inotropes进行充分的肾灌注，以及避免或减少肾毒性药物。

急性透析质量倡议（ADQI）小组建议开发机器学习模型，用于在诊断前48至72小时早期预测中度至重度AKI（2/3期），并建议预测模型应提供有关导致这些风险的患者测量的信息，并就潜在的可操作项目向从业者提供反馈[6]。

许多研究小组已经使用电子健康记录（EHR）数据解决了AKI的早期预测[8-11]，但迄今为止，尽管明确需要可解释和可操作的预测，但没有任何模型解释具体预测背后的原理[6，12]。在生理学随着年龄的增长而有很大差异的儿科患者中，开发一个预测模型来了解早期AKI的适龄迹象仍然是一个额外的挑战。

本研究旨在为普通儿科重症监护患者开发一个实时运行的AKI预测模型，该模型可以检测患者生理学的细微持续变化，并提醒护理人员注意AKI高危患者，并提供可解释的背景和建议的行动。

主要结果是能够在中重度AKI发生前6至48小时预测其发病。同样的模型也评估了与AKI相关的次要结果指标，包括任何AKI的发展（1/2/3阶段）和肾脏替代治疗（RRT）的需求。


据我们所知，这是第一个用于解释每个预测的AKI预测模型，也是第一个用于普通儿科重症监护AKI预测的多中心验证模型。

## Methods
### Study population
该研究队列包括来自三个独立的三级儿科重症监护的PICU和心胸重症监护室（CTICU）的患者中心。第一组数据来自2003年至2011年期间的一家美国医院（1号医院），第二组数据来自2009年至2015年期间的英国医院（2号医院）；第三组数据来自2014年至2019年期间的美国医院（3号医院）。本研究取消了记录的识别，并根据“拒绝”中的规定放弃了知情同意。    

### Derivation and validation data
来自三个中心的患者数据被分为推导（70%）、验证（15%）和坚持测试（15%）数据集，没有患者重叠。使用来自所有医院的推导和验证数据设计和训练一个单一的预测模型，然后在每个医院的拒诊测试数据上进行验证。


### Cohort extraction
利用肌酐测量结果按照KDIGO（慢性肾脏病国际指南组织）血清肌酐标准对AKI分级进行标注[5]。基线肌酐水平是通过按年龄和性别组别计算出的正常肌酐平均水平来确定的[14-16]。由于记录不可靠，未使用尿量作为标准。

发展中度至重度AKI的患者的AKI起始时间被定义为首个导致AKI分级为2或更高的肌酐测量时间；发展为分级1但不发展为2/3的AKI的患者的起始时间被定义为首个导致分级1的肌酐测量时间；未发展为AKI的患者的起始时间则被选定为住院期间的随机时间。

以下是排除标准：
1. 月龄低于一个月（新生儿）、21岁以上或没有有效年龄记录的患者；
2. 在ICU住院的前12小时内出现AKI的患者；
3. 住院时间少于24小时的患者；
4. 如果某一患者有多次就诊记录，则仅使用其中一次记录，其余就诊记录将被排除。被选择的就诊记录是具有最高AKI分级或最长住院时间的记录，如果多次就诊记录中的最高AKI分级一样，则选择住院时间最长的记录。

### Outcomes
主要结果是在发病前48至6小时内预测分级2/3的AKI。为了训练模型进行主要结果的预测，未患有AKI或患有分级1 AKI的患者被标记为对照组患者。训练后的模型还在次要结果上进行了测试，包括预测任何AKI（分级1/2/3）和预测是否需要进行肾脏替代治疗（RRT）。
### Baseline comparator
肾血管性心绞痛指数（RAI）被证明可以预测PICU入院时的AKI[17]，被用作基线比较指标。在AKI发生之前，计算了RAI，具体计算方法详见附加文件1，并与模型的预测结果进行比较。

### Predictors
从电子病历中提取了四种类型的数据元素，包括生命体征、实验室指标、药物治疗历史和通气参数，并将其用作构建和训练模型的预测因子。针对每个预测因子，计算了过去30小时内的均值、中位数、最小值、最大值、变化量和最后一个值的统计数据。对于肌酐，还通过计算在之前48小时内适应最小二乘法拟合线的肌酐测量结果，确定了肌酐变化率（CRoC）（以mg/dL/小时为单位）。

药物数据分为三类：低肾毒性潜力药物、高肾毒性潜力药物和血管活性药物，详见附加文件1。在过去一周内，每个类别的药物被使用的次数加总，并作为预测因子。这共计产生了250个候选预测因子，在经过特征选择过程后，最终确定了15个模型输入的预测因子，详见附加文件1中的表2。

注意：原文中提到的Additional file 1是附加文件中的具体内容，这些细节信息可能无法直接转换为文字描述。


### Statistical analysis methods
预测因子每隔六个小时进行聚合，以生成AKI风险预测。在模型设计和特征选择完成后，最终模型使用距离AKI发生前48到24小时的衍生和验证数据进行训练，并在AKI发生前48到6小时的保留数据上进行测试。当在给定时间段内一些预测因子缺失时，该模型能够进行预测，无需进行数据插补处理。

该模型是根据《个体预后或诊断的多变量预测模型的透明报告准则》[13]开发的。衍生和验证数据使用了一个年龄相关的集成机器学习模型进行训练[15]，如图1所示。该模型属于一类基于一组简单“弱分类器”集合求和进行分类的模型。对于每个预测因子和年龄组合，都会学习一个弱分类器，根据该预测因子的测量值来预测AKI风险。可以将弱分类器视为基于患者年龄和单个预测因子值（例如年龄和胆红素）的复杂查找表。模型考虑了年龄相关的风险，使其适用于广泛的患者年龄范围。图1显示了CRoC和高肾毒性潜力药物的示例弱分类器。

由于预测的AKI风险是所有弱分类器预测结果的总和，可以分离和排名每个非年龄预测因子在每个预测中的贡献。这使得模型能够显示每个预测中对最高风险的贡献最大的预测因子，从而使得AKI风险预测对用户来说是透明且可解释的。预测的风险通过验证校准曲线接近AKI发生率与预测风险对角线的程度进行合理校准和评估，如附加文件1所示。
## Results
表1显示了最终队列的人口统计学特征，包括每个医院的衍生、验证和保留队列的综合情况。模型使用了15个输入预测因子以及年龄作为输入，详见表2。


### Performance
训练后的模型在AKI预测方面表现良好，AUC-ROC从AKI发生前48到24小时的训练窗口内提高了0.83至0.89，而在训练窗口外略有下降，为0.85，如图2a所示。更详细的性能指标请参见附加文件1。图2b显示美国的两家医院（医院1和3）之间的模型性能相当，而英国的医院（医院2）的性能较差，可能是由于其数据规模较小和数据特征的差异（参见讨论部分）。在年龄较大的患者中，模型的性能稍好：在CDC定义的不同年龄组（1个月至2岁、2至12岁、12至16岁和16至21岁），AUC-ROC分别为0.84、0.90、0.88和0.95。该模型在PICU（儿科重症监护室）和CTICU（心脏外科重症监护室）患者之间没有性能差异。

根据表3的数据来看，在预测时间范围内，经过训练的模型可以识别出70%的肾脏替代治疗（RRT）患者、58%的AKI 2/3分级患者和41%的任何AKI患者。模型触发的AKI警报在任何AKI的真阳性（TP）与假阳性（FP）比率方面是一对一，这意味着每个TP预测中有一个未能发展为任何AKI的FP预测，对应着47%的阳性预测比率（PPV）。

中度到重度AKI患者能够在平均提前30小时被识别出来。48小时之前，16%的2/3分级患者就可以被确认，到发病前6个小时则增加至58%。对于RRT患者，70%的患者在发病前6小时或更早被识别出来。

通过该模型预测的大多数AKI患者在预测时间范围内接受了潜在的肾毒性药物治疗：在预测窗口期间，40%、70%和79%的TP患者分别接受了高、低或任何肾毒性潜力的药物治疗。

### Predictions for example patient
图1显示了对一个去匿名化患者进行的预测，该患者的血清肌酐测量一直在增加，但直到AKI发生时仍未超过KDIGO阈值。假设当前时间是发病前36小时，床边医务人员对于即将发生的AKI未知，继续给予具有肾毒性潜力的药物治疗。中间的图表显示了警报通知给护理人员的情况：除了提示“患者在接下来的48小时内有90%的风险发展为AKI”外，还提供了上下文信息，例如“正在使用氨基糖苷类药物”，以及哪些测量结果是造成高风险的主要因素。建议“审查药物剂量和指征”也会显示出来。

### Baseline comparator
相比之下，RAI在AKI预测方面的效果较差，在图2a和b中的AUC-ROC约为0.57，并且灵敏度和特异度见表3。RAI是在没有患者干细胞移植信息的情况下计算的，详见附加文件1。

## Discussion
这里描述的机器学习模型为PICU提供了一个预测工具，适用于年龄在1个月到21岁之间的患者，并且在AKI 2/3分级发生前的48小时内显示了较强的预测性能。该模型是使用来自三个￥￥PICU的多中心数据进行训练和验证的。根据表3的数据，该模型可以预测任何AKI发作的40％、所有2/3分级AKI发作的58％和需要随后RRT处理的发作的70％，并且假阳性与真阳性警报之比是一对一。模型优于更简单的比较模型RAI，RAI已被证明可预测危重病儿童的AKI[17]。该模型在实际发生之前中位数提前30小时预测到2/3分级AKI的发生，为临床干预提供了关键的时间窗口，可能防止AKI的发展或减轻其严重程度。

在四年前发表的共识论文中，ADQI小组呼吁为普通重症监护人群预测2/3分级AKI和与AKI相关的临床重要结果[6]。值得注意的是，ADQI指出，该工具的作用不仅是提供有关肾脏风险的反馈，还要提供有关贡献于这些风险的患者测量值的信息，并向从业者提供有关潜在可行￥￥项的反馈[6]。迄今为止，已经发表了许多关于AKI预测的研究，但没有一项专注于建立一个工具，以提供关于最相关的患者测量结果的信息作为行动指南。我们构建了这个模型，将透明度和可操作性作为主要目标，有意避开了可能达到更好性能的“黑匣子”神经网络模型。这也是首个经过多中心验证的PICU AKI预测模型。

### AKI predictors
这个经过多中心验证的模型证明存在一些共同可用的电子病历（EHR）数据元素，在不同机构之间保持一致，对于在肌酐升高之前提早指示AKI的发展非常有用。该模型使用的15个预测因子反映了在模型透明度和性能之间取得平衡的努力：有足够数量的预测因子可以提供患者状态的信息，但不会过多导致模型难以解释和过拟合。这些预测因子可以分为三类：（1）那些对肾脏健康产生因果影响的因子，例如给予肾毒性药物和庆大霉素谷值，（2）那些直接反映肾脏健康情况的因子，例如动态肌酐清除率（CRoC），以及（3）那些反映患者整体健康状况的较通用因子，例如白细胞计数（WBC）。每个预测因子的学习结果可以通过图1中的弱分类器可视化清晰地表达出来，显示出哪些测量值对低风险和高风险AKI有贡献，使用户在实时使用之前可以研究模型的内部运作方式。

### Impacting clinical workflow and improving outcomes
最终的目标是利用模型预测及早干预，防止AKI的发展。在预测出来但AKI完全发展之前，大多数（79%）被预测为高风险患者在此期间仍然接受可能具有肾毒性的药物治疗，这意味着在早期警报后这些药物本可以停止、减少或替换为其他非肾毒性药物。图1中示例患者就是一个典型的例子：在该患者被模型识别为高风险AKI后，仍然继续使用肾毒性药物。36小时前建议“审查药物剂量和指征”本可以提供一个关键的时间窗口以促进早期康复。

在将预测模型部署到真实世界环境中时，透明度、可解释性和可操作性对于赢得医护人员的信任至关重要。通过不仅呈现预测风险，还显示与警报相关的贡献最大的预测因子及其测量值，并提供建议的行动，该模型使医护人员能够快速检查预测是否符合其临床直觉，如图1所示。这满足了ADQI提出的对预测模型呈现贡献于预测风险的患者测量信息并向从业人员提供有关可能可操作事项的反馈的需求[6]。

研究显示，基于指南的非预测性实时AKI检测可以减少AKI发生率[18]，我们计划开展类似的基于预测的AKI监测的前瞻性研究，以进一步降低AKI的发生率。

### Performance variability across hospitals
该模型在英国医院的表现较美国医院差。这在一定程度上是由于数据规模不平衡造成的，与其他医院相比，英国医院的队列规模较小，因此训练的模型更多地捕捉到了代表其他两家医院的AKI前数据模式。正如表1所示，英国医院的患者年龄较年轻。模型对年轻患者的预测准确性较低，所以性能较差可能也是由于年轻患者过多。我们观察到英国医院和美国医院之间的数据模式存在其他差异，详见附加文件1。由于数据可用性的原因，这三家医院的数据集覆盖了不同的时间范围，并且不应对结果产生影响，因为治疗策略并未发生变化。

### Baseline comparator
与主要使用肌酐预测AKI的基准比较模型RAI[17]相比，该模型的表现更好。模型具有更好的性能是因为使用了额外的患者信息，如药物历史和实验室数值。此外，原本在RAI中使用的干细胞移植信息[17]，但在该模型中没有使用，可能 contributed to previously reported RAI 的更高性能，与这里计算出来的结果相比。由于目标是构建一个全面的PICU模型，可以仅使用即时可获得的信息对AKI风险进行自动评估，因此未包括EHR中不容易获取的患者共病、诊断类别和干细胞移植等上下文信息。

### Prediction frequency
由于该模型侧重于长期预测因子（如实验室数值）和AKI的疾病进展速度，因此该模型被设计为每6小时生成一次预测。这有助于减少警报疲劳，通过减少总体可能的警报数量，因为临床决策支持系统建议要保持简洁，并仅对最相关或最严重的情况进行警报，以减少重复警报导致的警报疲劳[19]。

## Limitations
由于数据可用性的原因，该模型仅使用肌酐来分级AKI。根据研究，最多有20%的AKI患者仅基于尿量标准进行诊断[20]，而缺乏尿液标准可能导致较以前描述的AKI发生率较低。这对模型结果产生了一些影响。首先，该模型对基于尿液分级的AKI患者的敏感性可能较低，并且可能会漏诊更多的患者。其次，一些被错误预测为基于肌酐分级AKI的假阳性患者可能是基于尿液分级的患者，因此在考虑到基于尿液分级的患者时，报告的阳性预测值（PPV）可能会增加。由于基于尿液分级的患者具有更差的预后，未来的目标是在尿液数据记录更可靠时改进模型。

尽管这是第一个在多中心数据上测试的儿科AKI预测模型，但模型的泛化能力尚未完全解决。鉴于当前的回顾性验证结果，还需在规模更大的非美国数据集上进行更多的验证工作。如何最好地呈现和将模型整合到工作流程中仍需要进一步测试。模型对入院原因和患者共病的表现尚不清楚。


## Conclusion
该研究描述的机器学习模型能够准确预测中度到重度AKI在发生前48小时内。该模型在三个￥￥的儿科重症监护中心进行了验证，包括儿科重症监护病房（PICU）和儿科心胸外科监护病房（CTICU），适用于1个月到21岁的广泛年龄范围。该模型具有良好的性能，并且通过提供早期警报和可操作的反馈，在临床环境中可能改善儿科AKI的结果。

