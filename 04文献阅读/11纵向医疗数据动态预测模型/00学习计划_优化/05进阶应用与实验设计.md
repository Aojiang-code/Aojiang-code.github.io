éå¸¸å¥½ï¼Œä¸‹é¢æ˜¯å®Œæ•´çš„ **ç¬¬äº”é˜¶æ®µï¼šå¤šæ¨¡å‹å®éªŒå¯¹æ¯”ä¸æŠ¥å‘Šç”Ÿæˆï¼ˆGRU-D vs RETAIN vs Transformerï¼‰** çš„å®æ“å­¦ä¹ è®¡åˆ’ï¼Œèšç„¦äºæ„å»ºç»Ÿä¸€çš„æ¨¡å‹å¯¹æ¯”å®éªŒæµç¨‹ã€ç»“æœå¯è§†åŒ–ä¸æ’°å†™ç§‘ç ”æŠ¥å‘Šçš„ç»“æ„å»ºè®®ã€‚

---

# ğŸ§ª ç¬¬äº”é˜¶æ®µï¼šå¤šæ¨¡å‹å¯¹æ¯”å®éªŒä¸ç»“æœæŠ¥å‘Šï¼ˆåŸºäº MIMIC-AKIï¼‰

---

## ğŸ¯ é˜¶æ®µç›®æ ‡

1. æ„å»ºç»Ÿä¸€å®éªŒæµç¨‹ï¼Œåˆ†åˆ«è®­ç»ƒ GRU-Dã€RETAIN å’Œ Transformerï¼›
2. å¯¹æ¯”ä¸åŒæ¨¡å‹åœ¨ AUCã€F1ã€Accuracy ä¸Šçš„è¡¨ç°ï¼›
3. è¾“å‡ºç»“æœè¡¨æ ¼ä¸å¯è§†åŒ–ï¼ˆæŸ±çŠ¶å›¾ã€é›·è¾¾å›¾ï¼‰ï¼›
4. æ€»ç»“å®éªŒç°è±¡ï¼Œç¼–å†™å®éªŒæŠ¥å‘Šå¤§çº²ã€‚

---

## â± æ¨èç”¨æ—¶ï¼š2â€“3 å¤©

---

## âœ… æ­¥éª¤ä¸€ï¼šå‡†å¤‡ç»Ÿä¸€è®­ç»ƒæµç¨‹å‡½æ•°

```python
from pyhealth.trainer import Trainer
from pyhealth.models import GRUD, RETAIN, Transformer

def train_and_evaluate(model_class, dataset, name):
    model = model_class(dataset)
    trainer = Trainer(model, metrics=["auc", "f1", "accuracy"])

    trainer.train(
        train_dataloader=train_loader,
        val_dataloader=val_loader,
        epochs=50,
        monitor="auc",
        patience=5
    )
    
    result = trainer.evaluate(test_dataloader=test_loader)
    result["model"] = name
    return result
```

---

## âœ… æ­¥éª¤äºŒï¼šé€ä¸ªè®­ç»ƒæ¨¡å‹å¹¶è®°å½•ç»“æœ

```python
results = []
results.append(train_and_evaluate(GRUD, processed_dataset, "GRU-D"))
results.append(train_and_evaluate(RETAIN, processed_dataset, "RETAIN"))
results.append(train_and_evaluate(Transformer, processed_dataset, "Transformer"))
```

---

## âœ… æ­¥éª¤ä¸‰ï¼šæ±‡æ€»ä¸ºè¡¨æ ¼å¹¶ä¿å­˜ CSV

```python
import pandas as pd

df = pd.DataFrame(results)
df.to_csv("results_model_comparison.csv", index=False)
print(df)
```

è¾“å‡ºç¤ºä¾‹ï¼š

| model       | auc  | f1   | accuracy |
| ----------- | ---- | ---- | -------- |
| GRU-D       | 0.86 | 0.72 | 0.79     |
| RETAIN      | 0.88 | 0.75 | 0.80     |
| Transformer | 0.84 | 0.70 | 0.78     |

---

## âœ… æ­¥éª¤å››ï¼šç»˜åˆ¶å¯¹æ¯”å›¾ï¼ˆæŸ±çŠ¶å›¾ + é›·è¾¾å›¾ï¼‰

### æŸ±çŠ¶å›¾

```python
df.plot(x="model", y=["auc", "f1", "accuracy"], kind="bar")
plt.title("Model Performance Comparison")
plt.ylabel("Score")
plt.ylim(0.6, 1.0)
plt.show()
```

### é›·è¾¾å›¾ï¼ˆæ¨èï¼‰

```python
import numpy as np
import matplotlib.pyplot as plt

metrics = ["auc", "f1", "accuracy"]
labels = df["model"].values
angles = np.linspace(0, 2*np.pi, len(metrics), endpoint=False).tolist()
angles += angles[:1]  # é—­åˆå›¾å½¢

fig, ax = plt.subplots(figsize=(6,6), subplot_kw=dict(polar=True))

for i, row in df.iterrows():
    values = row[metrics].tolist()
    values += values[:1]
    ax.plot(angles, values, label=row["model"])
    ax.fill(angles, values, alpha=0.1)

ax.set_xticks(angles[:-1])
ax.set_xticklabels(metrics)
ax.set_title("Radar Chart of Model Performance")
ax.legend(loc="upper right")
plt.show()
```

---

## âœ… æ­¥éª¤äº”ï¼šæ’°å†™å®éªŒæŠ¥å‘Šç»“æ„å»ºè®®

### ğŸ“„ æŠ¥å‘Šç»“æ„æ¨¡æ¿

| éƒ¨åˆ†         | å†…å®¹è¯´æ˜                                                          |
| ---------- | ------------------------------------------------------------- |
| èƒŒæ™¯ä»‹ç»       | ç®€è¦æè¿° AKI çš„é‡è¦æ€§ã€MIMIC æ•°æ®çš„ä¼˜åŠ¿ã€ä¸ºä½•è¿›è¡Œæ¨¡å‹å¯¹æ¯”                            |
| ä»»åŠ¡æè¿°       | æœ¬ç ”ç©¶ç›®æ ‡ä¸ºé¢„æµ‹ ICU ç—…äººåœ¨æœªæ¥ 7 å¤©æ˜¯å¦å‘ç”Ÿ AKIï¼›è¾“å…¥ä¸ºè‚Œé…ç­‰å®éªŒå®¤æŒ‡æ ‡æ—¶é—´åºåˆ—                |
| æ•°æ®å‡†å¤‡æ–¹æ³•     | æè¿°æ ·æœ¬ç­›é€‰ã€creatinine æå–ã€AKI æ ‡ç­¾æ„å»ºæµç¨‹ï¼Œæ ·æœ¬æ•°é‡ã€ç‰¹å¾ç»´åº¦ã€æ˜¯å¦æœ‰ç¼ºå¤±ç­‰æƒ…å†µ            |
| æ¨¡å‹é€‰æ‹©       | ç®€è¿°æ¯ä¸ªæ¨¡å‹ç»“æ„ä¸é€‰æ‹©ç†ç”±ï¼ˆGRU-D æ—¶é—´æ„ŸçŸ¥ã€RETAIN å¯è§£é‡Šæ€§ã€Transformer é•¿è·ç¦»å»ºæ¨¡ï¼‰       |
| å®éªŒè®¾ç½®       | è®­ç»ƒé›†/éªŒè¯é›†/æµ‹è¯•é›†æ¯”ä¾‹ã€batch sizeã€early stoppingã€è¯„ä¼°æŒ‡æ ‡è¯´æ˜                |
| ç»“æœå±•ç¤ºä¸åˆ†æ    | å›¾è¡¨å±•ç¤º AUC/F1/Accuracy å¯¹æ¯”ï¼Œæ–‡å­—åˆ†æå“ªç±»æ¨¡å‹æ›´é€‚åˆ AKI æ—¶åºæ•°æ®                  |
| å¯è§£é‡Šæ€§åˆ†æï¼ˆé€‰åšï¼‰ | å±•ç¤º RETAIN ä¸­å‘ç°çš„é«˜æ³¨æ„åŠ›ç‰¹å¾ï¼ˆå¦‚æŸäº› visit æˆ– creatinine ä¸Šå‡ç‚¹ï¼‰ï¼Œç»“åˆåŒ»å­¦çŸ¥è¯†åˆ†æå…¶åˆç†æ€§ |
| å±€é™ä¸æœªæ¥æ–¹å‘    | æ ·æœ¬æ•°æ˜¯å¦è¶³å¤Ÿï¼Ÿä»…ç”¨ LABEVENTS æ˜¯å¦è¦†ç›–ï¼Ÿæ˜¯å¦è€ƒè™‘çº³å…¥å¤šæ¨¡æ€æ•°æ®ï¼ˆå¦‚ Medicationã€Noteï¼‰      |

---

## âœ… ç¬¬äº”é˜¶æ®µå®Œæˆæ ‡å‡†

| æ£€æŸ¥ç‚¹                                 | æ˜¯å¦å®Œæˆ |
| ----------------------------------- | ---- |
| GRU-D / RETAIN / Transformer æ¨¡å‹è®­ç»ƒå®Œæˆ | âœ…    |
| ä¸‰æ¨¡å‹çš„ AUC/F1/Accuracy å‡å·²è¯„ä¼°           | âœ…    |
| æˆæœä»¥è¡¨æ ¼ + æŸ±çŠ¶å›¾ + é›·è¾¾å›¾å½¢å¼å±•ç¤º               | âœ…    |
| ç¼–å†™äº†è§„èŒƒåŒ–çš„æŠ¥å‘Šç»“æ„æˆ–æ‘˜è¦è‰ç¨¿                    | âœ…    |

---

## ğŸš€ è¡¥å……å»ºè®®ï¼ˆé«˜çº§æ‹“å±•æ–¹å‘ï¼‰

| æ‹“å±•æ–¹å‘      | å†…å®¹                                                              |
| --------- | --------------------------------------------------------------- |
| å¤šä»»åŠ¡é¢„æµ‹     | ç»“åˆ creatinine å›å½’ + AKI åˆ†ç±» + æœªæ¥ä½é™¢å¤©æ•°é¢„æµ‹ï¼ˆ`MultitaskPredictionTask`ï¼‰ |
| å¤šæ¨¡æ€å®éªŒ     | åŠ å…¥è¯Šæ–­ç ã€è¯ç‰©ã€ICD ç¼–ç ç­‰ç»“æ„åŒ–æˆ–æ–‡æœ¬ä¿¡æ¯ï¼›å®éªŒ LLM + æ—¶åºç»“åˆæ–¹æ¡ˆ                        |
| è½¬ç§»å­¦ä¹  / è¿ç§» | åœ¨ eICU æˆ–çœŸå®åŒ»é™¢æ•°æ®ä¸Šå¾®è°ƒå·²è®­ç»ƒå¥½çš„æ¨¡å‹                                        |
| è‡ªåŠ¨è°ƒå‚      | ç”¨ Optuna / RayTune è‡ªåŠ¨æœç´¢è¶…å‚ç»„åˆ                                     |

---

## ğŸ“‚ é¡¹ç›®å»ºè®®ç›®å½•ç»“æ„ï¼ˆå®éªŒç®¡ç†ï¼‰

```
pyhealth_project/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ 10_compare_models.py       âœ… ä¸»è„šæœ¬
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ results_model_comparison.csv
â”‚   â”œâ”€â”€ radar_plot.png
â”‚   â””â”€â”€ bar_chart.png
â”œâ”€â”€ report/
â”‚   â””â”€â”€ aki_model_comparison_draft.md
```

---

ä¸‹ä¸€æ­¥ä½ å¸Œæœ›æˆ‘ï¼š

1. âœï¸ å¸®ä½ å†™å‡ºä¸€ä»½åˆæ­¥çš„ç§‘ç ”æŠ¥å‘Šè‰ç¨¿ï¼ˆä¸­è‹±æ–‡åŒè¯­ï¼ŒåŸºäºä¸Šè¿°ç»“æ„ï¼‰ï¼Ÿ
2. ğŸ§ª æä¾›å®Œæ•´çš„ `compare_models.py` è„šæœ¬ï¼Ÿ
3. ğŸ§  å¼€å§‹è¿›å…¥è¿ç§»å­¦ä¹ æˆ–å¤šä»»åŠ¡é¢„æµ‹çš„å®æ“è·¯å¾„ï¼Ÿ

ä½ å¯ä»¥é€‰æ‹©ç»§ç»­ï¼Œä¹Ÿå¯ä»¥è®©æˆ‘ååŠ©æ•´ç†å‰äº”é˜¶æ®µçš„å®Œæ•´å®æ“è„šæœ¬æ¨¡æ¿åˆé›†ã€‚
