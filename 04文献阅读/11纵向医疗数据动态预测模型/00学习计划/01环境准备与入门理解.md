éå¸¸å¥½ï¼Œæˆ‘ä»¬å°†æŒ‰ä½ æ‰€éœ€ï¼Œä»å¤´ç³»ç»Ÿå­¦ä¹  PyHealthï¼Œæ¯ä¸€èŠ‚éƒ½è¯¦ç»†è®²è§£åŸç†å¹¶é…åˆ Jupyter Notebook ç¤ºä¾‹ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å³å°†å¼€å§‹çš„ç¬¬ä¸€ä¸ªæ¨¡å—ï¼š

---

# âœ… ç¬¬ä¸€é˜¶æ®µï¼šç¯å¢ƒå‡†å¤‡ä¸å…¥é—¨ç†è§£ï¼ˆPart 1ï¼‰

## ğŸ¯ ç›®æ ‡

* å®‰è£… PyHealth åŠç›¸å…³ä¾èµ–
* äº†è§£ PyHealth çš„æ•´ä½“æ¶æ„ä¸æ•°æ®æµ
* è·‘é€šä¸€ä¸ªæœ€ç®€å•çš„å®˜æ–¹ Demoï¼ˆç†è§£ pipelineï¼‰

---

## 1.1 ç¯å¢ƒå‡†å¤‡ä¸å®‰è£…

### ğŸ“¦ æ¨èç¯å¢ƒé…ç½®

å»ºè®®ä½¿ç”¨ Conda è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨ï¼Œæˆ– pip æ­å»ºçº¯å‡€ç¯å¢ƒï¼š

```bash
conda create -n pyhealth_env python=3.9 -y
conda activate pyhealth_env
pip install pyhealth
```

âš ï¸ PyHealth ä¾èµ– PyTorchï¼Œé¦–æ¬¡ä½¿ç”¨è¯·ç¡®è®¤æ˜¯å¦å®‰è£…æˆåŠŸï¼š

```bash
pip install torch torchvision
```

### ğŸš€ è¡¥å……å¸¸ç”¨ä¾èµ–ï¼ˆæ¨èï¼‰

```bash
pip install pandas numpy scikit-learn matplotlib seaborn jupyterlab tqdm
```

---

## 1.2 PyHealth æ¶æ„æ¦‚è§ˆ

PyHealth çš„æ¶æ„å¦‚ä¸‹å›¾é€»è¾‘ï¼š

```
Raw EHR Data
   â†“
Dataset æ„é€ ï¼ˆMIMIC3Dataset, PatientDataset ç­‰ï¼‰
   â†“
Task å®šä¹‰ï¼ˆBinaryPredictionTask, LabPredictionTaskï¼‰
   â†“
Modelï¼ˆLSTMModel, GRUDModel, RETAINModel...ï¼‰
   â†“
Trainer æ¨¡å—è®­ç»ƒä¸éªŒè¯
   â†“
æ¨¡å‹ä¿å­˜ / åŠ è½½ / æ¨ç†
```

PyHealth ä¸­æœ€é‡è¦çš„ç±»ç»“æ„åˆ†å¸ƒåœ¨ä»¥ä¸‹æ¨¡å—ä¸­ï¼š

| æ¨¡å—                  | åŠŸèƒ½ç®€è¿°                    |
| ------------------- | ----------------------- |
| `pyhealth.datasets` | åŠ è½½å’Œè½¬æ¢åŒ»ç–—æ•°æ®é›†ï¼ˆå¦‚ MIMICï¼‰     |
| `pyhealth.models`   | å¤šç§æ”¯æŒåŒ»ç–—æ•°æ®çš„æ·±åº¦å­¦ä¹ æ¨¡å‹         |
| `pyhealth.tasks`    | å®šä¹‰æ¨¡å‹é¢„æµ‹ä»»åŠ¡ï¼ˆè¯Šæ–­ã€å†å…¥é™¢ã€å®éªŒå®¤é¢„æµ‹ç­‰ï¼‰ |
| `pyhealth.trainer`  | æ¨¡å‹è®­ç»ƒå™¨ï¼Œç»Ÿä¸€è®­ç»ƒæ¥å£            |
| `pyhealth.metrics`  | è¯„ä¼°æŒ‡æ ‡æ¨¡å—ï¼ˆAUCã€F1ã€MAE ç­‰ï¼‰    |

---

## 1.3 æœ€å°åŒ– Demo ç¤ºä¾‹ï¼ˆNotebookï¼‰

æ¥ä¸‹æ¥æˆ‘ä»¬è·‘ä¸€ä¸ªæœ€ç®€æµç¨‹ï¼Œä½¿ç”¨ PyHealth è‡ªå¸¦çš„ ToyDatasetï¼ˆå†…ç½®æ¨¡æ‹Ÿæ•°æ®ï¼‰å®Œæˆåˆ†ç±»ä»»åŠ¡ã€‚

ğŸ““ æ‰“å¼€ `Jupyter Notebook`ï¼Œæ–°å»ºæ–‡ä»¶ï¼š`01_pyhealth_get_started.ipynb`

```python
# 01_pyhealth_get_started.ipynb

# Step 1: å¯¼å…¥ç›¸å…³æ¨¡å—
from pyhealth.datasets import SampleEHRDataset
from pyhealth.tasks import BinaryPredictionTask
from pyhealth.models import LSTMModel
from pyhealth.trainer import Trainer

# Step 2: åŠ è½½å†…ç½® toy æ•°æ®é›†ï¼ˆ10ä½ç—…äººï¼Œ3ä¸ªå°±è¯Šè®°å½•ï¼‰
dataset = SampleEHRDataset()

print(f"ç—…äººæ•°é‡: {len(dataset.patients)}")
print(f"ç¬¬ä¸€ä¸ªç—…äººçš„å°±è¯Šè®°å½•æ•°: {len(dataset.patients[0].visits)}")

# Step 3: æ„å»ºä¸€ä¸ªä»»åŠ¡ï¼ˆå¦‚è¯Šæ–­é¢„æµ‹ï¼‰
task = BinaryPredictionTask(
    dataset=dataset,
    feature_keys=["conditions", "procedures"],
    label_key="label",
    time_order=True
)

# Step 4: åˆå§‹åŒ–æ¨¡å‹
model = LSTMModel(task=task, hidden_size=64)

# Step 5: åˆå§‹åŒ– Trainer
trainer = Trainer(
    model=model,
    train_dataset=task.split(0.8)[0],
    val_dataset=task.split(0.8)[1],
    epochs=5,
    batch_size=2,
    optimizer_params={"lr": 1e-3}
)

# Step 6: è®­ç»ƒå¹¶éªŒè¯
trainer.train()
```

è¿è¡Œåä½ ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```
[Train] Epoch 1: loss=0.68 acc=0.51 auc=0.51 ...
[Val]   Epoch 1: loss=0.65 acc=0.58 auc=0.62 ...
...
```

ä½ å·²ç»æˆåŠŸç”¨ PyHealth è·‘é€šäº†å®Œæ•´æµç¨‹ï¼

---

## âœ… æœ¬èŠ‚å°ç»“

ä½ å·²ç»å®Œæˆäº† PyHealth çš„å®‰è£…ã€æ¨¡å—ç†è§£ä»¥åŠæœ€å° Demo è·‘é€šï¼š

| å†…å®¹                     | æ˜¯å¦å®Œæˆ âœ… |
| ---------------------- | ------ |
| å®‰è£… PyHealth åŠä¾èµ–        | âœ…      |
| ç†è§£ PyHealth æ¶æ„         | âœ…      |
| è·‘é€š SampleEHRDataset æµç¨‹ | âœ…      |

---

**ä¸‹ä¸€èŠ‚ï¼šæˆ‘ä»¬å°†è¿›å…¥â€œç¬¬äºŒé˜¶æ®µï¼šæ•°æ®å‡†å¤‡ä¸è½¬æ¢â€ï¼Œå­¦ä¹ å¦‚ä½•ç”¨è‡ªå·±çš„è‚¾ç—…æ•°æ®æ„å»º PyHealth æ•°æ®é›†ç»“æ„ã€‚**
æˆ‘ä¼šæ•™ä½ å¦‚ä½•å°†ä½ çš„ç”µå­è¡¨æ ¼/CSV æ•°æ®ï¼Œè½¬æ¢ä¸º PyHealth æ‰€éœ€æ ¼å¼ï¼Œå¹¶ä¿å­˜ä¸ºæ ‡å‡†å¯¹è±¡ã€‚

å‡†å¤‡å¥½è¿›å…¥ç¬¬äºŒé˜¶æ®µäº†å—ï¼Ÿå¦‚æœä½ æœ‰ä½ è‡ªå·±çš„æ•°æ®æ ¼å¼ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä¼˜å…ˆå¸®ä½ è½¬ã€‚æ˜¯å¦ç»§ç»­ï¼Ÿ
