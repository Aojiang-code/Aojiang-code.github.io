# 使用机器学习预测卵巢癌

> [原文链接](https://pubmed.ncbi.nlm.nih.gov/32485554/)
> [kaggle链接](https://www.kaggle.com/datasets/saurabhshahane/predict-ovarian-cancer)
> [原始数据](https://data.mendeley.com/datasets/th7fztbrv9/11)
> 2020年3月1日收稿，2020年4月24日修订，2020年5月21日接受，2020年5月23日在线发布，2020年5月30日记录版本。

代码
> [Intermediate ML Techniques for Detection of Cancer](https://www.kaggle.com/code/tobaadesugba/intermediate-ml-techniques-for-detection-of-cancer)
> [01Intermediate_ML_Techniques_for_Detection_of_Cancer注释](04文献阅读\03妇产科\02卵巢癌\01使用机器学习预测卵巢癌\01Intermediate_ML_Techniques_for_Detection_of_Cancer注释\README.md)

##  亮点 
* 利用两种生物标志物（人附睾蛋白 4 (HE4) 和癌胚抗原 (CEA)）的简单决策树模型可以准确分类良性卵巢肿瘤 (BOT) 和卵巢癌 (OC)。
* CEA 是低 HE4 患者 OC 预测的一个有价值的标志物。
* 机器学习模型可用于揭示卵巢癌等复杂疾病的模式。


## 摘要

### 意义
**卵巢癌（OC）**是女性最常见的癌症类型之一。准确预测**卵巢良性肿瘤（BOT）**和**卵巢癌（OC）**具有重要的实用价值。

### 方法
我们的数据集包含 **349 名中国患者**，具有 **49 个变量**，包括:
* **人口统计**、
* **血常规检查**、
* **一般化学**和
* **肿瘤标志物**。


* **训练集**:对**235名**患者数据（89名BOT和146名OC）应用机器学习最小冗余-最大相关性（MRMR）**特征选择方法**来选择最相关的特征，并以此构建简单的**决策树模型**。
* **测试集**：该模型在其余** 114 名**患者（89 名 BOT 和 25 名 OC）上进行了测试。将结果与使用**卵巢恶性肿瘤风险算法 (ROMA)** 和**逻辑回归模型**产生的预测进行比较。


**训练集**：**测试集** = **2：1**

### 结果 
MRMR 选择了 **8 个显着特征**，其中两个被**决策树模型**确定为最重要的特征：**人附睾蛋白 4 (HE4)** 和**癌胚抗原 (CEA)**。特别是，CEA 是低 HE4 患者 OC 预测的一个有价值的标志物。该模型还产生了比 ROMA 更好的预测结果。


### 结论

* 机器学习方法能够准确地对 BOT 和 OC 进行分类。
* 我们的目标是推导出一个简单且具有良好性能的预测模型。
* 使用我们的方法，我们获得了仅包含两个生物标志物 HE4 和 CEA 的模型。该模型易于解释并且优于现有的 OC 预测方法。
* 它表明机器学习方法在复杂疾病的预测建模方面具有良好的潜力。



### 关键词 

* Ovarian Cancer 卵巢癌 
* Tumor Marker 肿瘤标志物 
* Machine Learning 机器学习 


## 1. 介绍 

卵巢癌（OC）是女性最常见的癌症类型之一。
> 研究发现，2018年全球有295,414名女性被诊断出患有卵巢癌，并导致184,799人因此死亡[ ]。
> 大多数卵巢癌患者在诊断时已处于晚期疾病，因为早期肿瘤通常无症状，导致长期生存较差。
> 尽管卵巢癌对化疗敏感，并且通常对铂类/紫杉烷治疗显示出初步疗效，但晚期疾病患者的 5 年复发率为 60% 至 80%。
> 因此，相当多的努力集中在建立预测这种恶性肿瘤的疾病进展和预后的新方法上。


诊断患者是否患有卵巢癌，除了体检（包括盆腔检查）或经阴道超声检查外，还需结合肿瘤生物标志物如糖类抗原125（CA125）、糖类抗原72-4（CA72-4）[ ] 和人附睾蛋白 4 (HE4) [ ] 经常在临床上进行评估。

已经进行了许多研究来评估这些生物标志物的性能以及利用它们的指数（例如风险卵巢恶性肿瘤算法（ROMA）[]，一种利用HE4和CA125的双标志物算法；基于图像特征的风险恶性肿瘤指数（RMI） 、绝经状态和 CA125 [ ]）以区分良性状态和 OC。

> 安东等人。比较了 CA125、HE4、ROMA 和 RMI 对 128 名患者的敏感性，结果表明 HE4 对卵巢恶性肿瘤的评估表现出最佳的总体敏感性。
> 
> 摩尔等人。比较了 RMI 和 ROMA 对 457 名女性的上皮性卵巢癌 (EOC) 的预测结果，得出的结论是，ROMA 在识别患有 EOC 的女性方面比 RMI 具有显着更高的灵敏度 [ ]。
> 
> 王等人。 基于 32 项研究，进行了一项荟萃分析来评估 HE4、CA125 和 ROMA 的诊断价值，他们认为 HE4 对于诊断 OC 很有用，尤其是在绝经前人群中。 CA125和ROMA更适合诊断绝经后人群的OC。
> 
> 张等人。通过结合 HE4、CA125、孕酮 (Prog) 和雌二醇 (E2)，开发了一个线性多标志物模型，最后两个标志物由 OC 发生和进展的流行病学证据的数量表明[,]。与 CA125 或 HE4 相比，他们的多标志物模型在区分良性盆腔肿块 (BPM) 和 EOC 患者方面显示出显着改善 [1]。


总之，目前用于诊断 OC 的临床测试集中在少数生物标志物上，这些生物标志物是通过满足基因/蛋白质过度表达标准 [1] 或流行病学证据来选择的。

机器学习（ML）是一个新兴的研究领域，它提供了各种可以处理大维数据集的有用方法，并且擅长提供可以高效且有效地评估大量变量以构建准确的预测模型的方法[，，， ，]。

在医学研究中，决策树等机器学习方法已成功应用于预测创伤[，]和乳腺癌[]的死亡率。

在这项研究中，我们将采用机器学习的方法，通过研究来自 **349 名患者的 49 项指标**来开发预测模型，其中包括**人口统计学、血常规测试、一般化学和用于分类 BOT 和 OC 的肿瘤标志物**。

## 2. 材料和方法
### 2.1. 患者和肿瘤特征 

样本采集自 171卵巢癌患者和178名良性患者

2011年7月至2018年7月在苏州大学第三附属医院接受手术切除的患者（补充资料1）。
2011年7月至2017年7月收集的235名患者数据被用作模型开发的**训练数据**（估算数据参见补充数据3，原始数据参见补充数据4，描述参见补充表1）。
其余114例患者2017年8月至2018年7月收集的数据作为**检测数据**（检测数据说明见补充表2，原始数据见补充数据5）。
所有患者术后均经病理确诊。卵巢癌患者均未接受术前化疗或放疗。
组织学类型根据世界卫生组织（WHO）标准进行分类。
患者的人口统计和组织学类型信息列于Table 1 表1 .

### 2.2. 血常规检查、一般生化检查、肿瘤标志物检测方法

血常规检测采用Sysmex XE-2100全自动血液分析仪（Sysmex，日本）对全血进行分析。一般生化检测采用贝克曼库尔特AU5800系列临床生化分析仪（美国贝克曼库尔特）对血清进行分析。采用Roche Cobas 8000模块化分析仪系列（Roche，瑞士）对血清进行肿瘤标志物分析。各测试项目的详细实验方法列于补充数据2中。

### 2.3. 统计分析

所有统计分析均使用 SPSS 22.0 软件（SPSS，Inc.，芝加哥，伊利诺伊州）和 GraphPad Prism 8.0 软件包（GraphPad Software，Inc.，圣地亚哥，美国）进行。计算数据的中位数和 IQR（四分位距）。
对于非正态分布数据采用Mann-Whitney U检验比较两组差异，对于正态分布数据采用t检验。
基于双侧检验的P值小于0.05被认为具有统计显着性。

## 3. 机器学习分析
### 3.1. 缺失值
对于数据集中的变量，大多数具有较低的缺失值率（缺失小于7%），除了CA74-4缺失69%和中性粒细胞比率（%）（训练数据100%完整，测试数据缺失80%） ）。对于缺失值率较低的变量，使用其平均值进行估算。


### 3.2. 特征选择
在我们的数据集中，它由 49 个变量组成，包括组织学、人口统计学、血常规检查、一般化学、肿瘤标志物，如图所示
表1 .

为了有效地为机器学习准备高维数据，我们采用了数据降维策略，即特征选择，它可以帮助导出干净且最相关的数据子集来预测结果（良性/OC）。使用 Python scikit-feature 库 (http://featureselection.asu.edu/) 执行特征选择。


### 3.3. 最小冗余 - 最大相关性 (MRMR)
一般来说，过滤器类型的特征选择方法（基于互信息[] 或统计检验（t 检验、F 检验）[] 或统计检验（t 检验、F 检验）[]）使用简单的排名方法来识别与目标类最相关的特征，其中仅选择排名靠前的特征。他们忽略了这样一个事实，即所选的期货之间可能高度相关，从而在所选特征之间产生“冗余”问题。鉴于所选特征可能高度相关，它们并不能最大程度地代表与目标类别的潜在“相关性”空间。 MRMR是Ding和Peng等人提出的一种滤波器型特征选择方法[].MRMR 的目标是找到与目标类别最相关的特征，同时还要确保这些被选中的特征相互之间具有最大的相似性。鉴于上述两个条件，MRMR 通过将其合并为一个单一的准则函数来同时优化这两个条件。第一个条件（最小冗余条件）的目的是找到一组相互最大程度不相似的特征，可表示为


$公式1$


$此处省略了一些内容$

MRMR算法选择彼此远离但仍与目标变量具有“高”相关性的显着特征变量。互信息可用于量化每个特征变量与目标变量之间的依赖性。 MRMR 是一种有监督的特征选择模型，它最大化所选特征的联合分布与目标变量之间的依赖性。在本研究中进行 MRMR 时，我们数据集中的数值特征被转换为 10 组分类变量。


为了确定用于构建决策树模型的最佳特征数量，根据我们数据集中的变量数量进行了 48 次 MRMR 特征选择实验（CA72-4 由于其百分比较高而未包括在内）缺失值，参见补充数据3)。在每个第 i ( i =1 到 48) 次实验中，算法将样本分为大小相等的 10 组。 MRMR 根据随机的 9 组样本选择前 i 个特征，然后仅使用相同 9 组样本上的选定特征构建 5 级 CART 决策树模型。然后在剩余1组样本上测试CART模型，并评估模型性能的准确性和F1分数。每个实验重复此过程 10 次。记录准确度和 F1 分数的平均值和标准偏差值，以及每个实验选择的特征。


### 3.4. ReliefF特征选择

ReliefF是选择特征来将实例与不同类分开。它也被认为是一种基于相似性的方法，因为它相当于选择保留特殊形式的数据相似性矩阵的特征。该方法可用于处理连续和离散特征变量。我们使用 MRMR中描述的相同程序执行 ReliefF 特征选择，以比较它们的特征选择结果。

### 3.5. 卵巢恶性肿瘤风险算法（ROMA）计算


### 3.6. 决策树模型
决策树是一种用于分类和回归的非参数监督学习方法。我们选择决策树的原因是（1）它易于理解和解释。它可以根据构建的树制定 if-then 类型的规则来解释生物标志物与卵巢癌之间的潜在关系，（2）它需要最少的数据预处理，（3）它可以处理数值和分类数据，因为我们的数据集包含两者数值和分类变量。

在构建的决策树中，每个叶节点对应一个类标签，每个内部节点代表对特征（本研究中的生物标记）的测试。构建的决策树是使用称为分类和回归树（CART）[ ]的分类算法构建的二叉树。本研究中使用的决策树模型的实现包由Python Scikit-learn[ ]提供。


### 3.7. 逻辑回归

逻辑回归是一种用于分析数据集的统计方法，其中有一个或多个决定结果的自变量。结果是用二分变量来衡量的。在我们目前的研究中，决策树模型选择的两个顶级特征被用来拟合逻辑回归模型，该模型的预测概率和真实分类被用来构建混淆矩阵 表2 。根据混淆矩阵计算敏感性、特异性、阳性预测值、阴性预测值和准确率。


### 3.8. 建模过程图解
图1 是表示上述建模步骤的流程图，包括将患者分配到训练组和测试组的描述、特征选择方法、决策树模型开发以及与ROMA和逻辑回归模型的结果比较。


> 图1. 表示本研究中建模过程的流程图，包括对患者分配到训练组和测试组的描述、特征选择方法、决策树模型开发以及与 ROMA 和逻辑回归模型的结果比较。


## 4. 结果 
### 4.1. 统计数据 
两个独立样本的 t 检验或秩和检验被用来实现 BOT 和 OC 组之间的比较(表1)。

28个变量间差异有统计学意义(P < 0.05)。它们是:

一个人口统计学变量
*年龄 ，

11个血常规检查:
* 平均红细胞血红蛋白，
* 血小板分布宽度，
* 血红蛋白，
* 淋巴细胞计数，
* 淋巴细胞比率，
* 单核细胞计数，
* 血小板计数，
* 嗜中性粒细胞比率，
* 红细胞计数，
* 血小板细胞比容，
* 红细胞比容 ，

12个一般化学:
* 葡萄糖，
* 天冬氨酸转氨酶，
* 白蛋白，
* 间接胆红素，
* γ 谷氨酰转移酶，
* 球蛋白，
* 直接胆红素，
* 钠，
* 钙，
* 总蛋白，
* 总胆红素，
* 碱性磷酸酶

4个肿瘤标志物:
*碳水化合物抗原72-4，
α-胎儿蛋白，
人附睾蛋白4，
碳水化合物抗原125。


### 4.2. 特征选择

MRMR 特征切片在235例患者数据的训练数据集上进行。图2显示了我们48个 MRMR 实验的特征选择结果。在 A)和 B)中，x 轴表示我们在每个实验中使用的特征的数量，而在 A 中的 y 轴是来自10倍交叉验证的平均准确度，在 B 中的 y 轴是来自10倍交叉验证的平均 f 1得分。




> 图2. 我们使用 MRMR 和 ReliefF 进行的 48 次实验的特征选择结果。在所有图中（A、B、C 和 D），x 轴代表我们在每个实验中使用的特征数量，而 A 和 C 中的 y 轴是 10 倍交叉验证的平均准确度B 和 D 中的 y 轴是 10 倍交叉验证的平均 F1 分数。 A 和 B 中的结果来自 MRMR，C 和 D 中的结果来自 ReliefF。从 ReliefF 的结果（C 和 D）来看，平均准确度和 F1 分数都达到最大值，直到包含低排名特征。而 MRMR 的结果（A 和 B），平均准确度和 F1 分数都遵循相同的趋势增加，并且在选择排名前 10 的特征时变得稳定。


如图2 A & B 所示，随着模型中包含的特征数量的增加，平均 F1得分和平均准确度都会增加，并且当特征数量达到10左右时，它们会变得稳定。因此，我们检查了第10个实验，其中选择了10个特征。在所有10倍模拟中发生最频繁的8个特征包括更年期，年龄，AFP，CEA，HE4，CA19-9，LYM% 和 CO2CP (补充数据6)。


对于 ReliefF 特征选择，如图2 C & D 所示，ReliefF 中分类模型的准确性和 F1评分达到最大值，直到包括低排名特征如 HE4和 CEA (补充数据7)。这一结果可以突出 HE4和 CEA 是重要的预测因子。结果还表明，ReliefF 的顶部特征不如 MRMR 所选择的特征具有较好的预测性能。因此，我们使用来自 MRMR 的这八个特征来构建最终的决策树模型。

### 4.3. 决策树

利用训练数据集建立了一个简单的两级 CART 决策树模型，结果如图3所示。该模型有四个末端节点，树木顶部两个水平上仅出现来自 MRMR 八个特征的两个生物标志物(HE4和 CEA)。其余六个特征没有被前两个级别的决策树模型选中。其规则和结果如下:


* 节点 C: 如果 HE4≤70.73 pmol/L，CEA ≤3.12 ng/mL，预测 BOT (85/111或76.6%)
* 节点 D: 如果 HE4≤70.73 pmol/L，CEA > 3.12 ng/mL,预测 OC (16/18或88.9%)
* 节点 E: 如果 HE4 > 70.73 pmol/L 和 HE4 < = 91.24 pmol/L，预测 OC (4/6或66.7%)
* 节点 F: 如果 HE4 > 91.24 pmol/L，预测 OC (100/100或100%)

> 图3. 决策树模型由两个特征组成：HE4和CEA，用于BOT和OC的分类。

### 4.4. 模型评估与比较

如我们的决策树模型(图2)和文献中的其他一些工作所示，CEA [31]和 HE4[8,7,32,9,33,34,15,5,20]显示出区分 OC 和 BOC 的强预测能力。在训练数据集上使用 HE4和 CEA 开发了一个 Logit模型模型。Logit模型的方程式是:



在训练和测试数据集上，将决策树模型的预测性能与 ROMA 和 Logit模型模型进行了比较。
每个模型的混淆矩阵、敏感度、特异度、阳性预测值、阴性预测值及准确率结果载于表2。

* 对于决策树模型，训练数据集的灵敏度、特异度、阳性预测值、阴性预测值和准确率分别为0.822、0.955、0.968、0.766和0.872，
* ROMA 分别为0.74、0.888、0.915、0.675和0.796，
* Logit模型模型分别为0.753、1、1、0.712和0.847。

* 在114例患者数据的测试数据集中，
* ROMA 的灵敏度、特异度、阳性预测值、阴性预测值和准确率分别为0.92、0.966、0.885、0.977和0.956，
* 决策树模型分别为1、0.899、0.735、1和0.921，
* Logit模型模型分别为0.96、0.978、0.923、0.989和0.974。

每个模型的 ROC 结果如图4所示，与 ROMA (0.814，SE: 0.029，p = 0.045)和 Logit模型模型(0.877，SE: 0.023，p = 0.735)相比，我们的决策树模型在训练数据上具有最佳的 AUC (0.888，SE: 0.023)。
在测试数据方面，决策树模型的 AUC (0.949，SE: 0.020，p = 0.876)与 ROMA (0.943，SE 0.033)和 Logit模型模型(0.969，SE: 0.024，p = 0.522)比较。


> 表 2. ROMA、决策树和逻辑回归的模型性能指标按训练和测试数据分开。


## 5.结论与讨论
作为女性最常见的癌症类型之一，使用生物标志物对良性和恶性卵巢癌进行准确分类对许多人的生活有着深远的影响。因此，提高卵巢癌早期诊断和检测的准确性具有重要意义。我们应用机器学习特征选择方法 MRMR 系统地研究了包含患者人口统计学，血常规检查，一般化学和肿瘤标志物的变量列表，以选择最相关的特征来预测卵巢癌。然后利用训练数据集(235例患者)中选择的特征得到一个简单的两级决策树，并在一个独立的数据集(114例患者)上进行测试。


我们的决策树模型表明，HE4和 CEA 两种生物标志物的组合对卵巢癌和良性卵巢肿瘤的分类具有最显著的预测能力。有趣的是，来自我们的决策树模型的 HE4临界值为70.73 pmol/L，并且与其他研究中使用的 HE4临界值一致[11,6]。此外，对于 HE4值小于70.73 pmol/L 的患者，我们的模型表明，如果他们的 CEA 水平大于3.12 ng/mL，他们也可能高度可能有 OC。癌胚抗原是一种常用的血清生物标记物，可用于诊断大肠癌、乳腺癌、肺癌等实体肿瘤。根据我们的研究，表明 CEA 是一个有价值的标志物预测 OC 的患者在 HE4低组。这一发现为研究 CEA 在卵巢癌中的作用提供了新的视角。


如结果部分所示，只使用这两种生物标志物，决策树模型在训练和测试数据中的预测结果均优于 ROMA (ROC 的决策树和 ROMA 的训练数据分别为0.888和0.814，测试数据分别为0.949和0.943) ，其使用 HE4，CA125和更年期状态的值，是卵巢癌诊断中常用的指标[35]。结果亦可与 Logit模型模式比较(ROC 的决策树 AUC 为0.888，训练数据 Logit模型为0.877，测试数据 AUC 为0.949，测试数据 AUC 为0.969)。虽然 Logit模型在测试数据中显示出稍高的 AUC 值，但决策树模型的优势在于它有 if-then 规则，这使得医疗专业人员更容易理解和解释。此外，Logit模型还利用了特征选择和决策树分析得出的特征 HE4和 CEA，这在另一方面表明了 HE4和 CEA 的高预测值。总之，我们对卵巢癌研究领域的贡献是我们发现使用 HE4和 CEA 可以产生一个简单而高效的 BOT 和 OC 分类模型。我们的研究表明，ML 模型可以用来揭示复杂疾病的模式，如卵巢癌。这项研究的未来工作可能是开发一个工具，结合在这项研究中开发的决策树模型，并将其应用于一个大型队列的患者进行进一步验证。












