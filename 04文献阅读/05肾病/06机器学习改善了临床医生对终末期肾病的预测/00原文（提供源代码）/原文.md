# 原文

Machine Learning Improves Upon Clinicians' Prediction of End Stage Kidney Disease
机器学习改善了临床医生对终末期肾病的预测

## Abstract  摘要
### Background and Objectives    背景和目标
Chronic kidney disease progression to ESKD is associated with a marked increase in mortality and morbidity. Its progression is highly variable and difficult to predict.

慢性肾脏疾病进展为ESKD与死亡率和发病率显著增加相关。它的发展变化很大，难以预测。

### Methods  方法
This is an observational, retrospective, single-centre study. The cohort was patients attending hospital and nephrology clinic at The Canberra Hospital from September 1996 to March 2018. Demographic data, vital signs, kidney function test, proteinuria, and serum glucose were extracted. The model was trained on the featurised time series data with XGBoost. Its performance was compared against six nephrologists and the Kidney Failure Risk Equation (KFRE).

这是一项观察性、回顾性、单中心研究。该队列是1996年9月至2018年3月期间在堪培拉医院医院和肾脏科诊所就诊的患者。提取人口统计学数据、生命体征、肾功能检查、蛋白尿和血糖。该模型使用XGBoost在特征化的时间序列数据上进行训练。它的性能进行了比较，对六个肾脏病学家和肾衰竭风险方程（KFRE）。

### Results  结果
A total of 12,371 patients were included, with 2,388 were found to have an adequate density (three eGFR data points in the first 2 years) for subsequent analysis. Patients were divided into 80%/20% ratio for training and testing datasets.

共纳入12，371例患者，发现2，388例患者具有足够的密度（前2年的3个eGFR数据点）用于后续分析。患者被分为80%/20%的比例进行训练和测试数据集。

ML model had superior performance than nephrologist in predicting ESKD within 2 years with 93.9% accuracy, 60% sensitivity, 97.7% specificity, 75% positive predictive value. The ML model was superior in all performance metrics to the KFRE 4- and 8-variable models.

ML模型预测2年内ESKD的准确性为93.9%，敏感性为60%，特异性为97.7%，阳性预测值为75%，优于肾脏科医师。ML模型在所有性能指标上均上级KFRE 4变量和8变量模型。

eGFR and glucose were found to be highly contributing to the ESKD prediction performance.

发现eGFR和葡萄糖对ESKD预测性能有很大贡献。

### Conclusions  结论
The computational predictions had higher accuracy, specificity and positive predictive value, which indicates the potential integration into clinical workflows for decision support.

计算预测具有更高的准确性，特异性和阳性预测值，这表明可能整合到临床工作流程中以提供决策支持。

## Keywords: machine learning (ML), prediction model, end stage kidney disease (ESKD), XGBoost (Extreme Gradient Boosting), chronic kidney disease

关键词：机器学习（ML），预测模型，终末期肾病（ESKD），XGBoost（极端梯度增强），慢性肾病

## Introduction  介绍
Chronic kidney disease (CKD) is a major cause of morbidity and mortality globally, having a reported prevalence of 11–13% (1). The prevalence of CKD is rising, especially in developed nations where lifestyle related diseases are endemic (2). Whilst CKD may ultimately culminate in end stage kidney disease (ESKD), rate of progression is highly variable and difficult to predict. ESKD is associated with a marked increase in mortality and morbidity: it is a terminal condition without renal replacement therapy (RRT) in the form of haemodialysis, peritoneal dialysis, or kidney transplantation. As ESKD approaches, patients and clinicians are required to make difficult decisions (3). RRT requires the formation of permanent dialysis access and/or evaluation of suitability for transplantation. Preparation for RRT is associated with significant cost and risks of complications, such as post-operative infection and bleeding (4). Premature access formation exposes patients to these risks without benefit and, in some cases, result in RRT access not being used at all (5). However, the capacity of physicians to correctly predict patient outcomes is poor (6). Therefore, any method which will improve the ability to correctly identify patients who will require RRT is highly desirable.

慢性肾脏疾病（CKD）是全球发病率和死亡率的主要原因，据报道患病率为11-13%（ 1 ）。CKD的患病率正在上升，特别是在发达国家，生活方式相关疾病是地方病（ 2 ）。虽然CKD可能最终以终末期肾病（ESKD）告终，但进展速度变化很大，难以预测。ESKD与死亡率和发病率显著增加相关：它是一种终末期疾病，无需血液透析、腹膜透析或肾移植形式的肾脏替代治疗（RRT）。随着ESKD的临近，患者和临床医生需要做出艰难的决定（ 3 ）。RRT需要形成永久性透析通路和/或评估移植的适用性。RRT的准备与显著的成本和并发症风险相关，如术后感染和出血（ 4 ）。 过早形成通路使患者暴露于这些风险而无获益，在某些情况下，导致RRT通路根本无法使用（ 5 ）。然而，医生正确预测患者结局的能力很差（ 6 ）。因此，任何能够提高正确识别需要RRT的患者的能力的方法都是非常可取的。

Data-driven predictive modeling is a rapidly advancing field and has been employed in a range of clinical scenarios such as opioid overdose (7) and acute kidney injury (8). Recent advances have demonstrated the capacity of predictive modeling to robustly predict acute kidney injury in individuals with varying levels of kidney function (8). For CKD, multiple risk factors for initiation and progression to ESKD have been characterized (9). The most pronounced risk factors include male gender, proteinuria, excess weight, hypertension and diabetes (10, 11). Statistical modeling of these data has been shown to be predictive of an individual developing CKD (12, 13). Application of machine learning (ML) approaches in small clinical cohorts has been shown to be capable of predicting accurate estimated glomerular filtration rate (eGFR) values (14, 15). Analysis of over sixty thousand electronic medical records (EMRs) and prediction with a random forest regression method has shown eGFR to be predicted with a correlation coefficient of better than 0.95 (16). However, to date, ML has not been used to predict the clinical outcomes of ESKD or death in CKD. It has also not been compared pragmatically to the predictions of expert clinicians.

数据驱动的预测建模是一个快速发展的领域，已被用于一系列临床场景，如阿片类药物过量（ 7 ）和急性肾损伤（ 8 ）。最近的进展已经证明了预测建模能够稳健地预测具有不同肾功能水平的个体中的急性肾损伤（ 8 ）。对于 CKD，已经描述了启动和进展为 ESKD 的多种风险因素（ 9 ）。最明显的风险因素包括男性、蛋白尿、超重、高血压和糖尿病（ 10 、 11 ）。这些数据的统计建模已被证明可预测个体发生 CKD（ 12 ， 13 ）。机器学习（ML）方法在小型临床队列中的应用已被证明能够预测准确的估计肾小球滤过率（eGFR）值（ 14 ， 15 ）。 对超过 6 万份电子病历（EMR）的分析和随机森林回归方法的预测表明，eGFR 的预测相关系数优于 0.95（ 16 ）。然而，迄今为止，ML 尚未用于预测 ESKD 的临床结局或 CKD 的死亡。它也没有被实用地与临床专家的预测进行比较。

In this work, we describe the training of a ML model that was capable of predicting which CKD patients will progress to ESKD within 2 years. We compare the predictive power of this model against the prospective predictions of six nephrologists in a cohort of fifty CKD patients. The predictions for ESKD occurring within a 2-year period were better than the most experienced clinician. The work here shows that predictive models built with machine learning can be accurate and have a potential role in providing decision support in a clinical environment.

在这项工作中，我们描述了ML模型的训练，该模型能够预测哪些CKD患者将在**2年内**进展为ESKD。我们将该模型的预测能力与6名肾病学家在50例CKD患者队列中的前瞻性预测进行比较。2年内发生ESKD的预测优于最有经验的临床医生。这里的工作表明，用机器学习构建的预测模型可以是准确的，并且在临床环境中提供决策支持方面具有潜在的作用。

> 为什么是2年内？不是1年内？5年内？

## Methods  方法
### Data Cleaning  数据清洗
The raw clinical time-series data included much manually entered information, and included erroneous extreme outliers in some variables, particularly, height, weight, standing systolic pressure, standing heart rate and protein-creatinine. These were outliers detected and removed using chi-squared outlier tests with an inclusion threshold of 99.999999%, excluding points with a p-value of lesser than 10−8 for distribution membership. A total of 538 outlying points were flagged, out of 869,901 data points (0.062%).

原始临床时间序列数据包括许多手动输入的信息，并包括一些变量的错误极端离群值，特别是身高、体重、站立收缩压、站立心率和蛋白质-肌酐。这些是使用卡方离群值检验检测并删除的离群值，包含阈值为99.999999%，不包括分布成员p值小于10−8的点。在869，901个数据点中，共标记了538个离群点（0.062%）。

### Data Filtering  数据过滤
Out of 12,371 patients extracted 7,565 patients recorded an eGFR value. We filtered the primary data to remove patients with fewer than three pre-ESKD eGFR measurements. This filtering step retained 4,477 patients. Primary measures of creatinine level were excluded from subsequent study due to the output predictor, eGFR, being derived from it.

在提取的**12，371例**患者中，**7，565例**患者记录了eGFR值。我们过滤了主要数据，以排除ESKD前eGFR测量值少于3次的患者。该过滤步骤保留了**4，477名**患者。由于输出预测因子eGFR来源于肌酐水平的主要指标，因此将其从后续研究中排除。

### Machine Learning Model  机器学习模型
The Training Span (TS) and the Test Timepoint (TT) values were chosen as a trade-off between accuracy and the clinical usefulness of the size of the prediction window. Here, TS = 2 and TT = 8 years provided the most clinically relevant predictor, with a large amount of useful training data and relatively high accuracy. With this selection of TS, we removed patients who had reached ESKD within 2 years of commencement of their data collection. This reduced our sample size to 2,388 patients.

选择训练跨度（TS）和测试时间点（TT）值作为预测窗口大小的准确性和临床有用性之间的权衡。在这里，TS= 2和TT= 8年提供了最具临床相关性的预测因子，具有大量有用的训练数据和相对较高的准确性。通过选择TS，我们排除了在数据收集开始后2年内达到ESKD的患者。这将我们的样本量减少到**2，388例**患者。

> 为什么排除了在数据收集开始后2年内达到ESKD的患者？

### Data Partitioning  数据划分
To ensure that the model was trained on distinct data to the test data, individual patients were fist randomly partitioned into two groups. 80% (N = 1,910) of the patients formed the training set and the remaining 20% (N = 478) was used for testing. To ensure that a similar proportion of ESKD patients were randomly included in each set, a two-sample test for equality of proportions with continuity correction was performed, which confirmed that the proportions were not significantly different (χ2 = 0.000538, p = 0.9812).

为了确保模型是在与测试数据不同的数据上训练的，个体患者首先被随机分为两组。80%（N= 1，910）的患者形成训练集，其余20%（N= 478）用于测试。为确保每组随机纳入相似比例的ESKD患者，进行了连续性校正的比例相等性双样本检验，证实比例无显著差异（χ2 = 0.000538，p= 0.9812）。

### Time-Series Featurisation    时间序列特征化
Data from 19 different time-series from each of the 1,910 training and 478 test patients was featurised with the tsfresh v0.12.0 python library (17), using the internal Comprehensive calculator setting to produce 764 features per individual timeseries (including power spectral density, Fourier, cosine and wavelet transforms). Four case studies with varying degrees of Comprehensive featurisation was performed: zero (all Minimal), 2 (only eGFR and glucose), 6 (adding standing heart rate, systolic and diastolic blood pressure and heart rate), and 19 (all Comprehensive).

来自 1，910 名训练患者和 478 名测试患者的 19 个不同时间序列的数据使用 tsfresh v0.12.0 python 库（ 17 ）进行特征化，使用内部 Comprehensive 计算器设置为每个时间序列产生 764 个特征（包括功率谱密度，傅立叶，余弦和小波变换）。进行了 4 项具有不同程度综合特征的病例研究：0（均为极轻微 ）、2（仅 eGFR 和葡萄糖）、6（增加站立位心率、收缩压和舒张压以及心率）和 19（均为综合 ）。

### Model Training and Hyperparameter Tuning    模型训练和超参数调整
A model was trained on the featurised time series data for the 1,910 training set patients with XGBoost (18) (version 0.90.0.2), as implemented in R 3.6.1. This method is particularly suited to efficiently handle sparse data. Since the prediction accuracy of XGBoost can vary greatly according to various hyperparameters, we performed 10-fold cross-validation (CV) and hyperparameter grid search across five frequently-cited (19) tunable XGBoost parameters (nrounds, eta, max_depth, subsample, colsample_bytree). In order to properly handle the over 8-fold class imbalance between ESKD cases (N = 263) and non-ESKD cases (N = 2,125), the metric for tuning and evaluating performance of the predictive models was changed from accuracy to Area Under the Precision-Recall Curve, AUCPR (20). Upon subsequent prototyping, the Matthews Correlation Coefficient (MCC) metric, reported to be optimal for imbalanced binary classification (21), indeed performed better than AUCPR on our dataset and was solely employed in all subsequent analyses. The highest 10-fold CV mean MCC of 0.4327 corresponded with nrounds = 200, eta = 0.01, max_depth = 4, subsample = 1, colsample_bytree = 0.8, and this hyperparameter set was used to build the final optimal model employing the entire training dataset. The fully-featurised (all-Comprehensive) run had a 10-fold CV mean MCC of 0.4303 with the corresponding best hyperparameter set: nrounds = 500, eta = 0.04, max_depth = 4, subsample = 1, colsample_bytree = 0.6. SHapley Additive exPlanation (SHAP) values (22) were calculated and graphed using the SHAPforxgboost 0.0.2 R library (23). Our software and trained models are available for download from (https://github.com/catlyst/trendal).

使用XGBoost（ 18 ）（版本0.90.0.2）在1，910名训练集患者的特征化时间序列数据上训练模型，如R 3.6.1中所实现。这种方法特别适合于有效地处理稀疏数据。由于XGBoost的预测精度会因不同的超参数而有很大差异，因此我们对五个经常被引用的（ 19 ）可调XGBoost参数（nrounds，eta，max_depth，subsample，colsample_bytree）进行了10倍交叉验证（CV）和超参数网格搜索。为了正确处理ESKD病例（N= 263）和非ESKD病例（N= 2，125）之间超过8倍的类别不平衡，调整和评估预测模型性能的指标从准确度变更为精确度-召回曲线下的面积AUCPR（ 20 ）。 在随后的原型设计中，马修斯相关系数（MCC）度量，据报道是最佳的不平衡的二进制分类（ 21 ），确实比AUCPR在我们的数据集上表现得更好，并单独用于所有后续的分析。最高10倍CV平均MCC为0.4327，对应于nrounds= 200，eta= 0.01，max_depth= 4，subsample= 1，colsample_bytree= 0.8，该超参数集用于使用整个训练数据集构建最终最佳模型。完全特征化（全综合）运行的10倍CV平均MCC为0.4303，相应的最佳超参数集为：nrounds= 500，eta= 0.04，max_depth= 4，subsample= 1，colsample_bytree= 0.6。使用SHAPforxgboost 0.0.2 R库（ 23 ）计算SHapley加法解释（SHAP）值（ 22 ）并作图。 我们的软件和训练模型可从（ https://github.com/catlyst/trendal ）下载。


## Results  结果
### Dataset  数据集
We obtained pathology and clinical records for patients attending hospital and outpatient clinics at The Canberra Hospital Department of Renal Medicine, Australian Capital Territory, Australia. This included 12,371 patients spanning 21.5 years from September 1996 to March 2018. In addition to birth year, sex and date of death, this dataset consists of 17 time-stamped clinical measures including creatinine and derived eGFR (168,500 points each), glucose (145,961 points), sitting and standing blood pressure (42,818 points), heart rate (28,741 points), weight (47,981 points), height (35,421 points) and derived Body Mass Index (BMI), HbA1c (15,349 points), urine protein-creatinine ratio (14,777 points) and 24-h proteinuria (883 points). All data was observed in a normal distribution with the exception of creatinine, eGFR, glucose, HbA1c, proteinuria and urine protein/creatinine ratio (Supplementary Figure 1). In addition to the clinical measures, we derived two features, sitting and standing pulse pressure. With the addition of these derived measures, a total of 19 time-based measurements were obtained. We applied a threshold of three eGFR data points obtained in the first 2 years for each individual as a required minimum data density for subsequent analysis. From 7,565 patients, 2,388 were found to have adequate density for ML prediction (31.6%) (Supplementary Figure 2).
我们获得了在澳大利亚澳大利亚首都直辖区的堪培拉医院肾内科就诊的患者的病理学和临床记录。其中包括12，371名患者，从1996年9月到2018年3月，历时21.5年。除了出生年份、性别和死亡日期外，该数据集还包括17个时间戳临床指标，包括肌酐和推导的eGFR（各168，500点），葡萄糖（145,961分）、坐位和站立位血压（42，818分），心率（28,741分），体重（47,981分），身高（35，421分）和衍生的身体质量指数（BMI），HbA 1c（15，349分），尿蛋白-肌酐比值（14，777分）和24小时蛋白尿（883分）。除肌酐、eGFR、葡萄糖、HbA 1c、蛋白尿和尿蛋白/肌酐比值（ Supplementary Figure 1 ）外，所有数据均呈正态分布。除了临床测量外，我们还获得了两个特征，即坐位和站立位脉压。 加上这些衍生的措施，共获得了19个基于时间的测量。我们将每个个体前2年获得的3个eGFR数据点作为阈值，作为后续分析所需的最小数据密度。在7，565名患者中，发现2，388名具有足够的密度用于ML预测（31.6%）（ Supplementary Figure 2 ）。

Out of 2,388 patients, 1,910 were used to train the model and 478 were used as a holdout test dataset. Patients baseline characteristics are shown in Table 1. There was no difference in the age at presentation, gender proportion, diagnosis, and CKD stage. The majority of patients were in CKD stage 2 and 3.
在2，388名患者中，1，910名用于训练模型，478名用作保持测试数据集。患者基线特征见 Table 1 。在就诊年龄、性别比例、诊断和CKD分期方面没有差异。大多数患者为CKD 2期和3期。












### Machine Learning Model Identifies EGFR and Cardiovascular Risk Factors as Key Predictors of ESKD    机器学习模型EGFR和心血管危险因素作为ESKD的关键预测因素
We aimed to develop a model capable of predicting whether a patient would reach ESKD and to estimate the timeframe in which this would occur. We first aggregated individual patients' clinical measurements into a single, initial predictive model, including potentially interacting and confounding variables (see Methods). Throughout this analysis, we defined ESKD as the composite endpoint of an eGFR below a threshold of 10 mL/min/1.73 m2 (24) or the commencement of RRT, whichever came first. Using the initial model, we then incorporated data for each patient with an observation period, or training span (TS), of 2 years to predict if the patient would reach ESKD by a test timepoint (TT) of 8 years. The initial model incorporated all 19 time series measures present in the primary data and this was augmented with full featurisation derived from these timeseries (see Methods). When predicting if ESKD would occur by 8 years follow-up, the initial model had a prediction accuracy for ESKD of 84.5% with a sensitivity and specificity of 55.8 and 88.0%, respectively.
我们的目标是开发一种能够预测患者是否会达到ESKD的模型，并估计这种情况发生的时间范围。我们首先将个体患者的临床测量结果汇总到单个初始预测模型中，包括潜在的相互作用和混杂变量（参见方法）。在整个分析过程中，我们将ESKD定义为eGFR低于阈值10 mL/min/1.73 m2（ 24 ）或RRT开始（以先发生者为准）的复合终点。使用初始模型，我们然后将每个患者的数据与2年的观察期或训练跨度（TS）相结合，以预测患者是否会在8年的测试时间点（TT）达到ESKD。 初始模型包含了原始数据中存在的所有19个时间序列指标，并通过从这些时间序列中获得的完整特征化进行了增强（见方法）。当预测8年随访时是否会发生ESKD时，初始模型对ESKD的预测准确率为84.5%，灵敏度和特异性分别为55.8%和88.0%。

To understand the relative contribution of each feature in the initial model, SHapley Additive exPlanation (SHAP) values (25) were calculated, representing the weight of a particular feature in the model's ESKD prediction outcome. A SHAP value >0 suggests the feature value is a risk for ESKD, and <0 suggests the feature value is protective against the risk of ESKD.
为了理解初始模型中每个特征的相对贡献，计算SHapley加法解释（SHAP）值（ 25 ），其表示模型的ESKD预测结果中特定特征的权重。SHAP值>0表明特征值是ESKD的风险，并且<0表明特征值对ESKD的风险具有保护作用。

For the prediction of ESKD, as expected eGFR-based features (the minimum value and values at the 80, 20, and 10th percentiles) had the highest contributions, comprising six of the top 10 features (Table 2). Other quantities present in the top 10 predictive features included the patient's minimum standing heart rate, their age at first consultation and several derived or transformed values related to blood glucose levels and eGFR (Figure 1; Supplementary Figure 3). Further, blood glucose was a major contributor to the prediction of ESKD (6 of top 25 features) when >7 mmol/L (Figure 1; Table 2). Other identified features contributing to risk include known clinical risk factors such as blood pressure features including minimum standing diastolic blood pressure where a value of >75 mmHg increases risk. The model also identified other features such as minimum heart rate (increased risk at more than ~85 bpm), age at initial attendance (increased risk, <55 yrs) and mean pulse pressure difference between sitting and standing (increased risk, >10) which are not known as clinical risk factors for ESKD but appear to have cutoff values associated with ESKD risk. We hypothesized that increased cardiovascular disease explained the association of increased HR and pulse pressure difference, and that the competing interest of death at higher age groups made youth a risk factor for progression to ESKD.
对于ESKD的预测，正如预期的那样，基于eGFR的特征（最小值和第80、20和10个样本的值）具有最高的贡献，包括前10个特征中的6个（ Table 2 ）。前10个预测特征中存在的其他量包括患者的最低站立心率、首次咨询时的年龄以及与血糖水平和eGFR相关的几个推导或转换值（ Figure 1 ; Supplementary Figure 3 ）。此外，当>7 mmol/L时，血糖是预测ESKD的主要贡献者（前25个特征中的6个）（ Figure 1 ; Table 2 ）。其他确定的导致风险的特征包括已知的临床风险因素，例如血压特征，包括最低站立舒张压，其中>75 mmHg的值增加风险。 该模型还确定了其他特征，如最低心率（超过约85 bpm时风险增加），首次就诊时的年龄（风险增加，<55岁）和坐位与站立位之间的平均脉压差（风险增加，>10），这些特征不是ESKD的临床风险因素，但似乎具有与ESKD风险相关的临界值。我们假设心血管疾病的增加解释了HR和脉压差增加的相关性，并且较高年龄组死亡的竞争性利益使年轻成为ESKD进展的风险因素。


























Given the contribution of eGFR and glucose we modified our ML algorithm to emphasize these variables. We hypothesized that the prominence of eGFR and glucose suggested these variables contributed to the majority of the prediction. Further, we noted that the greatest data density existed for eGFR. We trained a further, optimized model utilizing all 19 time-series measures but only comprehensively-featurised two timeseries values: that of eGFR and glucose, which were featurised each into 764 numerical features. We then only minimally-featurised the remaining 17 timeseries values (eight numerical features each). In predicting ESKD at 8 years on 2 years of patient data, this optimized model improved prediction accuracy from 84.5 to 86.2%. Sensitivity improved from 55.8 to 65.4% and specificity from 88 to 88.7%. The most predictive quantities identified from this optimized model are only slightly different (Supplementary Table 1) from the initial model. Therefore, we concluded that unbiased predictions of ESKD by our ML algorithm is based on classic ESKD risk factors and has a strong predictive capability.
考虑到eGFR和葡萄糖的贡献，我们修改了ML算法以强调这些变量。我们假设eGFR和葡萄糖的显著性表明这些变量对大多数预测有贡献。此外，我们注意到eGFR的数据密度最大。我们利用所有19个时间序列指标训练了一个进一步优化的模型，但只对两个时间序列值进行了全面的特征化：eGFR和葡萄糖，每个值都被特征化为764个数值特征。然后，我们只对剩余的17个时间序列值进行了最小特征化（每个值有8个数值特征）。在根据2年患者数据预测8年ESKD时，该优化模型将预测准确率从84.5%提高到86.2%。敏感性从55.8%提高到65.4%，特异性从88%提高到88.7%。从该优化模型中识别的最具预测性的量与初始模型仅略有不同（ Supplementary Table 1 ）。 因此，我们得出结论，我们的ML算法对ESKD的无偏预测是基于经典的ESKD风险因素，具有很强的预测能力。

To contrast optimized model performance by disease severity, we grouped patients in the test set by their eGFR at presentation (either below, or at least, 30 ml/min/1.73 m2) (Supplementary Table 2). Out of 478 patients in the test set, 90 (18.8%) had presenting eGFR below 30 ml/min/1.73 m2, of which 26 patients (28.9%) developed ESKD within 8 years. In contrast, of the 388 patients with presenting eGFR of at least 30 ml/min/1.73 m2, only 6.7% developed ESKD.
为了根据疾病严重程度对比优化的模型性能，我们根据患者在就诊时的eGFR（低于或至少30 ml/min/1.73 m2）（ Supplementary Table 2 ）对测试集中的患者进行分组。在测试集中的478例患者中，90例（18.8%）eGFR低于30 ml/min/1.73m2，其中26例（28.9%）在8年内发生ESKD。相比之下，在388例eGFR至少为30 ml/min/1.73 m2的患者中，仅6.7%发生ESKD。

The model's accuracy in predicting ESKD in the former group was 67.8% (84.6% sensitivity, 60.9% specificity). In contrast, the accuracy of the model in the latter group was 90.4% (46.2% sensitivity, 93.6% specificity). These numbers highlight the sensitivity-specificity trade-off, which our single optimized model attempts to finely balance (overall accuracy 86.2% at 65.4% sensitivity and 88.7% specificity), but also suggests room for stratified ensemble models for future work.
模型预测ESKD的准确性为67.8%（敏感性84.6%，特异性60.9%）。与此相反，模型在后一组的准确性为90.4%（46.2%的灵敏度，93.6%的特异性）。这些数字突出了敏感性-特异性的权衡，我们的单一优化模型试图精细地平衡（在65.4%的敏感性和88.7%的特异性下，总体准确率为86.2%），但也表明分层集成模型在未来工作中的空间。

### Comparison of ML Algorithm Against Clinician Prediction    ML算法与临床医生预测的比较
Forty-nine patients with CKD at risk of ESKD were selected as a test cohort. We considered the risk of ESKD at 2 years to be of greater clinical significance for RRT planning. Therefore, 2 years of clinical data was utilized by ML algorithm to provide a probability of reaching ESKD within the next 2 years. Six consultant nephrologists were given baseline demographics and diagnosis, medical comorbidities, proteinuria, blood pressure, and eGFR measurements over 2 years for the same cohort. The nephrologists predicted prospectively for each individual, within a 10-year window, the number of years (to the nearest half-year) it would likely take for the patient to reach ESKD. The ML algorithm and clinician predictions were compared to the outcomes in the 49 patients at the 2-year mark (the time of writing). The variability in the clinician predicted ESKD date for each patient was high (Figure 2A). As expected each clinician appeared to have a systematic bias, predicting longer or shorter times until ESKD was reached for the same cohort (Figure 2B). Variation was also high in the number of predictions made, with some clinicians predicting that all patients will reach ESKD, while others did not. The pairwise-correlations in the predicted dates of each clinician with correlation-coefficients ranging from 0.257 to 0.757 (Supplementary Figure 4). Clinician performance compared to the predictive model was poor (Table 3). The ML algorithm demonstrated a 2-year predictive accuracy of 93.9%, with sensitivity of 60%, specificity of 97.7% and precision (or positive predictive value) of 75%. This was superior to all clinicians, with the best performance being Clinician 4, who had an accuracy of 79.6% (sensitivity 80%, specificity 79.5%, precision 30.8%). All other clinicians performed significantly worse, primarily due to higher false positive counts (Table 3). Cumulatively, this data suggests that trained predictive ML modeling may assist nephrologists in making predictions of ESKD.
选择49例有ESKD风险的CKD患者作为试验队列。我们认为2年时ESKD的风险对于RRT计划具有更大的临床意义。因此，ML算法利用2年的临床数据提供未来2年内达到ESKD的概率。6名顾问肾病学家被给予基线人口统计学和诊断，医学合并症，蛋白尿，血压和eGFR测量2年以上的同一队列。肾脏病学家在10年的时间窗内对每个个体进行前瞻性预测，患者可能需要多少年（最接近半年）才能达到ESKD。将ML算法和临床医生预测与49例患者在2年时（撰写本文时）的结局进行比较。临床医生预测的每例患者ESKD日期的变异性较高（ Figure 2A ）。 正如预期的那样，每位临床医生似乎都存在系统性偏倚，预测同一队列达到ESKD的时间更长或更短（ Figure 2B ）。预测数量的变化也很大，一些临床医生预测所有患者都将达到ESKD，而其他人则没有。每名临床医生预测日期的两两相关性，相关系数范围为0.257至0.757（ Supplementary Figure 4 ）。与预测模型相比，临床医生表现较差（ Table 3 ）。ML算法的2年预测准确率为93.9%，灵敏度为60%，特异性为97.7%，精确度（或阳性预测值）为75%。这上级所有临床医生，表现最好的是临床医生4，其准确性为79.6%（灵敏度80%，特异性79.5%，精确度30.8%）。所有其他临床医生的表现明显较差，主要是由于假阳性计数较高（ Table 3 ）。 累积起来，这些数据表明，经过训练的预测ML建模可以帮助肾脏病学家预测ESKD。





















### Comparison of ML Algorithm Against Kidney Failure Risk Equations    ML算法与肾衰竭风险方程的比较
The Kidney Failure Risk Equations (KFRE) (26) have been extensively used and validated to predict ESKD within 2 and 5 years. We used the updated 4- and 8- variable KFRE (13) to predict ESKD within 2 years for the test cohort of 49 patients, however as these equations rely on serum albumin tests, 3 patients had to be excluded (Table 4). The 4-variable KFRE (91.3% accuracy, 25% sensitivity, 97.6% specificity, 50% precision) performed better than the 8-variable KFRE (89.1% accuracy, 0% sensitivity, 97.6% specificity, 0% precision), which was consistent with validation studies (27), but both were inferior to our model.
肾衰竭风险方程（KFRE）（ 26 ）已被广泛使用并验证用于预测2年和5年内的ESKD。我们使用更新的4变量和8变量KFRE（ 13 ）预测49例患者的试验队列在2年内的ESKD，然而，由于这些方程依赖于血清白蛋白试验，因此必须排除3例患者（ Table 4 ）。4变量KFRE（91.3%准确度，25%灵敏度，97.6%特异性，50%精确度）优于8变量KFRE（89.1%准确度，0%灵敏度，97.6%特异性，0%精确度），这与验证研究（ 27 ）一致，但两者均劣于我们的模型。










### Other Metrics of Classification Performance    分类性能的其他类别
Like many other clinical predictive settings, one of the main challenges in building a reliable model was its class imbalance, e.g., in the clinician test cohort, only 5 out of the 49 patients actually reached ESKD, and even a null-predictor that predicts that none would reach ESKD would achieve a misleading accuracy of 89%. Commonly, F1 score (the harmonic mean of precision and recall) has been used to provide a fairer measure of predictor performance, but recently the Matthews correlation coefficient has been shown (28) to be better than both F1 and accuracy as a binary classification metric.
与许多其他临床预测设置一样，构建可靠模型的主要挑战之一是其类别不平衡，例如，在临床医生测试组群中，49名患者中只有5名实际达到ESKD，甚至预测没有人会达到ESKD的零预测器也会达到89%的误导性准确度。通常，F1得分（精确度和召回率的调和平均值）已被用于提供预测器性能的更公平的度量，但最近马修斯相关系数已被证明（ 28 ）优于F1和准确度作为二进制分类度量。

Revisiting our results (Tables 3, 4) shows that our model performs better at both F1 (0.667) and MCC (0.638) than the best of 6 clinicians (F1 = 0.444, MCC = 0.408) and the better of the KFRE predictors (F1 = 0.333, MCC = 0.271).
回顾我们的结果（ Tables 3 ， 4 ）表明，我们的模型在F1（0.667）和MCC（0.638）上的表现优于6名临床医生中最好的（F1= 0.444，MCC = 0.408）和KFRE预测器中最好的（F1= 0.333，MCC = 0.271）。


















































































































































































































































































































































































































































































































































































































































































































































