# 06机器学习改善了临床医生对终末期肾病的预测






## 一、文献信息


|项目|内容|
| ---- | ---- |
|标题|Machine Learning Improves Upon Clinicians’ Prediction of End Stage Kidney Disease|
|作者|Aaron Chuah, Giles Walters, Daniel Christiadi, Krishna Karpe, Alice Kennard, Richard Singer, Girish Talaulikar, Wenbo Ge, Hanna Suominen, T. Daniel Andrews, Simon Jiang|
|发表时间|2022-03-16|
|国家|澳大利亚|
|分区|Q1|
|影响因子|3.1|
|摘要|本研究通过机器学习模型改善了临床医生对终末期肾病的预测，展示了机器学习在临床决策支持中的潜力。|
|关键词|机器学习 (ML), 预测模型, 终末期肾病 (ESKD), XGBoost (Extreme Gradient Boosting), 慢性肾脏病|
|期刊名称|Frontiers in Medicine|
|卷号/期号|9:837232|
|DOI|10.3389/fmed.2022.837232|
|研究方法|观察性、回顾性、单中心研究|
|数据来源|澳大利亚堪培拉医院肾内科患者的临床数据|
|研究结果|机器学习模型在预测终末期肾病（ESKD）方面优于肾内科医生和传统预测工具KFRE|
|研究结论|机器学习模型在预测慢性肾脏病进展至终末期肾病方面具有更高的准确性、特异性和阳性预测值，具有潜在的临床应用价值|
|研究意义|为临床决策提供新的预测工具，优化患者管理，减少预测误差|


### 期刊信息

| **期刊名称**       | Frontiers in Medicine |
|:-------------------|:----------------------|
| **影响因子**       | 3.10                  |
| **JCR分区**        | Q1                    |
| **中科院分区(2025)** | 医学3区               |
| **小类**           | 医学：内科3区         |
| **中科院分区(2023)** | 医学3区               |
| **小类**           | 医学：内科3区         |
| **开放获取比例**   | 99.44%                |
| **出版周期**       | 暂无数据              |
| **是否综述**       | 否                    |
| **预警等级**       | 2021中科院国际期刊低度预警，多地黑名单预警（2023湘雅医学院、长江大学低风险预警、江苏省肿瘤医院低危、浙江工商大学、安徽省立医院） |

#### 年度数据

| 年度 | 影响因子 | 发文量 | 自引率 |
|------|----------|--------|--------|
| 2023 | 3.10     | 2539   | 3.2%   |
| 2022 | 3.90     | 3950   | 5.1%   |
| 2021 | 5.06     | 2676   | 4.3%   |
| 2020 | 5.09     | 982    | 2.2%   |
| 2019 | 3.90     | 285    | 1.3%   |



## 二、核心内容
这篇文献的核心内容是探讨机器学习（ML）模型在预测慢性肾脏病（CKD）进展至终末期肾病（ESKD）方面的性能，并将其与临床医生和传统预测工具（如肾脏衰竭风险方程，KFRE）进行比较。以下是文献的主要内容总结：

### 研究背景
慢性肾脏病（CKD）是一种全球性的重大健康问题，其进展至终末期肾病（ESKD）会导致显著的死亡率和发病率增加。ESKD患者需要进行肾脏替代治疗（RRT），如血液透析、腹膜透析或肾移植，这不仅增加了医疗成本，还带来了并发症风险。然而，CKD进展至ESKD的速度高度可变且难以预测，临床医生对患者预后的判断往往不够准确。因此，开发更准确的预测工具对于优化患者管理和治疗决策至关重要。

### 研究目的
本研究旨在开发和验证一种基于机器学习的预测模型，用于预测CKD患者在2年内是否会进展至ESKD，并将其性能与临床医生的预测和现有的KFRE模型进行比较。

### 研究方法
#### 数据来源
研究数据来自澳大利亚堪培拉医院肾内科的患者，时间跨度为1996年9月至2018年3月。研究纳入了12,371名患者，最终筛选出2,388名患者用于模型训练和测试。

#### 数据处理
- **数据清洗**：去除异常值和错误数据点。
- **数据筛选**：保留至少有3个eGFR数据点的患者。
- **时间序列特征提取**：使用tsfresh库对19个时间序列数据进行特征提取，生成764个特征。

#### 模型训练
- 使用XGBoost算法进行模型训练，通过10折交叉验证和超参数网格搜索优化模型性能。
- 采用Matthews相关系数（MCC）作为评估指标，以应对数据不平衡问题。

#### 模型验证
- 将患者随机分为训练集（80%）和测试集（20%）。
- 评估模型的准确性、敏感性、特异性、阳性预测值（PPV）等指标。

### 研究结果
#### 模型性能
- 机器学习模型在预测2年内ESKD的准确性为93.9%，敏感性为60%，特异性为97.7%，PPV为75%。
- 优化后的模型在8年时间框架内预测ESKD的准确性为86.2%，敏感性为65.4%，特异性为88.7%。

#### 与临床医生的比较
- 六位肾内科医生对同一队列患者的预测准确性范围为47%到81%。
- 机器学习模型在所有性能指标上均优于临床医生，尤其是特异性和PPV。

#### 与KFRE模型的比较
- 4变量KFRE模型的准确性为91.3%，敏感性为25%，特异性为97.6%。
- 8变量KFRE模型的准确性为89.1%，敏感性为0%，特异性为97.6%。
- 机器学习模型在所有性能指标上均优于KFRE模型。

#### 关键预测变量
- eGFR和血糖是预测ESKD的关键变量。
- 其他重要变量包括站立心率、年龄、血糖水平等。

### 研究结论
机器学习模型在预测CKD进展至ESKD方面表现出更高的准确性、特异性和PPV，优于临床医生和传统的KFRE模型。该模型具有潜在的临床应用价值，可以作为临床决策支持工具，帮助优化患者的治疗计划和预后评估。

### 研究意义
本研究展示了机器学习在医学领域的应用潜力，尤其是在处理复杂临床数据和预测疾病进展方面。通过整合大量临床数据，机器学习模型能够识别出与ESKD风险相关的经典和潜在新风险因素，为临床医生提供更准确的预测工具，从而改善患者的管理和治疗效果。

## 三、文章小结

以下是根据文献的节标题总结的各部分主要内容：

### Background and Objectives
- **背景**：慢性肾脏病（CKD）是全球主要的疾病负担之一，其进展至终末期肾病（ESKD）会导致死亡率和发病率显著增加。ESKD需要肾脏替代治疗（RRT），而准确预测CKD进展至ESKD对于优化治疗计划和患者管理至关重要。
- **目标**：开发一种基于机器学习（ML）的预测模型，用于预测CKD患者是否会在2年内进展至ESKD，并将其性能与临床医生和现有的肾脏衰竭风险方程（KFRE）进行比较。

### Methods
- **数据来源**：研究数据来自澳大利亚堪培拉医院肾内科，时间跨度为1996年9月至2018年3月，共纳入12,371名患者。
- **数据处理**：
    - 清洗数据，去除异常值。
    - 筛选至少有3个eGFR数据点的患者，最终保留2,388名患者。
    - 使用tsfresh库对19个时间序列数据进行特征提取，生成764个特征。
- **模型训练**：
    - 使用XGBoost算法进行模型训练。
    - 通过10折交叉验证和超参数网格搜索优化模型性能。
    - 采用Matthews相关系数（MCC）作为评估指标，以应对数据不平衡问题。
- **模型验证**：
    - 将患者随机分为训练集（80%）和测试集（20%）。
    - 评估模型的准确性、敏感性、特异性、阳性预测值（PPV）等指标。

### Results
- **模型性能**：
    - ML模型在预测2年内ESKD的准确性为93.9%，敏感性为60%，特异性为97.7%，PPV为75%。
    - 优化后的模型在8年时间框架内预测ESKD的准确性为86.2%，敏感性为65.4%，特异性为88.7%。
- **与临床医生的比较**：
    - 六位肾内科医生对同一队列患者的预测准确性范围为47%到81%。
    - ML模型在所有性能指标上均优于临床医生，尤其是特异性和PPV。
- **与KFRE模型的比较**：
    - 4变量KFRE模型的准确性为91.3%，敏感性为25%，特异性为97.6%。
    - 8变量KFRE模型的准确性为89.1%，敏感性为0%，特异性为97.6%。
    - ML模型在所有性能指标上均优于KFRE模型。
- **关键预测变量**：
    - eGFR和血糖是预测ESKD的关键变量。
    - 其他重要变量包括站立心率、年龄、血糖水平等。

### Discussion
- **研究意义**：
    - ML模型在预测CKD进展至ESKD方面表现出更高的准确性、特异性和PPV，优于临床医生和传统的KFRE模型。
    - 该模型具有潜在的临床应用价值，可以作为临床决策支持工具，帮助优化患者的治疗计划和预后评估。
- **模型优势**：
    - ML模型能够整合大量临床数据，并识别出与ESKD风险相关的经典和潜在新风险因素。
    - 模型的高特异性和PPV表明其在减少误报方面具有优势。
- **未来方向**：
    - 进一步优化模型，探索更多潜在风险因素。
    - 开发分层模型以适应不同疾病严重程度的患者。

### Conclusions
- **研究结论**：
    - ML模型在预测CKD进展至ESKD方面具有更高的准确性、特异性和PPV。
    - 该模型可以作为临床决策支持工具，帮助优化患者的治疗计划和预后评估。
- **潜在应用**：
    - ML模型可以整合到临床工作流程中，为临床医生提供决策支持。
    - 未来研究可以进一步探索ML在其他疾病预测中的应用。

### 其他部分
#### Introduction
介绍了CKD的全球负担、ESKD的严重性以及现有预测方法的局限性。
强调了机器学习在临床预测中的潜力。

#### Keywords
提供了研究的关键术语：机器学习（ML）、预测模型、终末期肾病（ESKD）、XGBoost、慢性肾脏病。

#### Data Availability Statement
研究数据可应要求提供。

#### Ethics Statement
研究获得伦理批准，无需患者书面同意。

#### Author Contributions
详细列出了每位作者的贡献。

#### Funding
描述了研究的资助来源。

#### Supplementary Material
提供了补充材料的链接，包括附加图表和数据。

## 四、主要方法和实施计划
这篇文献中描述的方法和实施计划主要围绕如何利用机器学习（ML）模型来预测慢性肾脏病（CKD）患者是否会进展至终末期肾病（ESKD）。以下是详细的方法和实施计划说明：

### 1. 数据收集与准备
- **数据来源**：
    - 数据来源：研究数据来自澳大利亚堪培拉医院肾内科的患者，时间跨度为 1996 年 9 月至 2018 年 3 月。
    - 数据类型：包括患者的临床记录、实验室检查结果、人口统计学信息等。
    - 具体变量：共收集了 17 个时间戳的临床测量指标，包括：
        - 血清肌酐和估算肾小球滤过率（eGFR）
        - 血糖
        - 坐位和立位血压
        - 心率
        - 体重、身高和体质指数（BMI）
        - 糖化血红蛋白（HbA1c）
        - 尿蛋白 - 肌酐比值和 24 小时蛋白尿
        - 计算得到的脉压差等
- **数据清洗与筛选**：
    - 数据清洗：去除手动输入的错误数据和异常值。使用卡方检验检测并移除极端异常值，设定阈值为 99.999999%，排除 p 值小于 10⁻⁸的数据点。
    - 数据筛选：从 12,371 名患者中筛选出至少有 3 个 eGFR 数据点的患者，最终保留 2,388 名患者用于分析。
    - 数据分区：将患者随机分为训练集（80%）和测试集（20%），确保两组中 ESKD 患者的比例相似。

### 2. 时间序列特征提取
- 特征提取工具：使用 tsfresh v0.12.0 Python 库对时间序列数据进行特征提取。
- 特征类型：包括功率谱密度、傅里叶变换、余弦变换和小波变换等，每个时间序列生成 764 个特征。
- 特征选择：根据临床相关性，对 eGFR 和血糖进行完全特征化（Comprehensive），对其余变量进行最小特征化（Minimal）。

### 3. 机器学习模型选择与训练
- **模型选择**：选择 XGBoost（Extreme Gradient Boosting）作为机器学习算法，因其适合处理稀疏数据且计算效率高。
- **超参数优化**：
    - 使用 10 折交叉验证和超参数网格搜索优化模型性能。
    - 调整的超参数包括：nrounds（迭代次数）、eta（学习率）、max_depth（树的最大深度）、subsample（子采样比例）和 colsample_bytree（列采样比例）。
    - 优化目标为 Matthews 相关系数（MCC），以应对数据不平衡问题。
- **模型训练**：
    - 在 1,910 名患者的训练集上进行模型训练。
    - 使用优化后的超参数（nrounds = 200，eta = 0.01，max_depth = 4，subsample = 1，colsample_bytree = 0.8）构建最终模型。

### 4. 模型验证与性能评估
- **验证数据集**：在 478 名患者的测试集上评估模型性能。
- **性能指标**：
    - 准确性（Accuracy）
    - 敏感性（Sensitivity）
    - 特异性（Specificity）
    - 阳性预测值（PPV）
    - F1 分数
    - Matthews 相关系数（MCC）
- **模型性能**：
    - 在 2 年时间框架内预测 ESKD 的准确性为 93.9%，敏感性为 60%，特异性为 97.7%，PPV 为 75%。
    - 优化后的模型在 8 年时间框架内预测 ESKD 的准确性为 86.2%，敏感性为 65.4%，特异性为 88.7%。

### 5. 与临床医生和传统模型的比较
- **临床医生预测**：
    - 选取 49 名 CKD 患者作为测试队列。
    - 六位肾内科医生根据患者的基线数据和 2 年内的临床数据预测患者在 10 年内达到 ESKD 的时间。
    - ML 模型在预测 2 年内 ESKD 的性能上优于所有临床医生。
- **与 KFRE 模型比较**：
    - 使用 4 变量和 8 变量的 KFRE 模型预测 2 年内 ESKD。
    - ML 模型在所有性能指标上均优于 KFRE 模型。

### 6. 特征重要性分析
- SHAP 值分析：使用 SHapley Additive exPlanation（SHAP）值评估每个特征对模型预测的贡献。
- **关键特征**：
    - eGFR（尤其是 80 百分位数、最小值等）和血糖是最重要的预测变量。
    - 其他重要特征包括站立心率、年龄、血压等。

### 7. 模型优化与未来工作
- **模型优化**：优化后的模型重点关注 eGFR 和血糖，进一步提高了预测性能。
- **未来工作**：
    - 探索更多潜在风险因素（如血清钾、碳酸氢盐、尿酸等）。
    - 开发分层模型以适应不同疾病严重程度的患者。
    - 将模型整合到临床工作流程中，验证其在实际临床环境中的应用价值。

### 总结
这篇文献详细描述了如何利用机器学习模型预测 CKD 患者是否会进展至 ESKD。研究通过数据清洗、特征提取、模型训练和验证等一系列步骤，展示了机器学习模型在预测性能上优于临床医生和传统预测工具的潜力。

## 五、重要变量和数据
请抓取文献中的主要变量信息，包括连续变量的均值、方差、中位数等等信息，以及分类变量的构成比、频率等信息，并用markdown表格的形式汇总数据，以便于我在接下来的工作中使用python代码模拟出这份数据。
为了以后操作方便，请您返回抓取的变量时使用文章中的英文原文


