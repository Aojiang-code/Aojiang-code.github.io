# 5概率与概率分布
当一个事件是随机事件时,为了衡量事件的可能性大小,科学家引入了概率的概念.换言之,概率衡量了随机事件的可能性大小.
- 关于概率的定义,有三种:概率的古典定义、概率的统计定义、主观概率定义.

一次随机事件的产生,可能会有不同的结果.这很容易理解,比如,抛一次硬币,是一次随机事件的产生,其结果可能是正面,也可能是反面.为了方便记录随机事件的不同结果,科学家引入了变量的概念.
- 变量是指随机事件可能出现的不同结果,由于随机事件会随机地产生不同的随机结果,所以在概率论中变量又被称为随机变量.
- **随机变量**是指随机事件可能出现的不同结果,为了下一步的计算和统计方便,随机变量常常用数字表示.
- - 如果用数字表示的随机变量不连续,则称之为**离散型随机变量**
- - 如果用数字表示的随机变量连续,则称之为**连续型随机变量**

如果将随机变量放在平面直角坐标系中,随机变量的概率为纵轴,随机变量为横轴,将会出现一个有意思的事:
- 对于离散型随机变量,你将会看到两条或两条以上垂直与X轴的线段(线段的高度代表其概率的大小,所有线段的长度相加等于1)
- 对于连续型随机变量,你将会看到一条平滑的曲线

离散型随机变量没啥多大意思,有意思的是连续型随机变量产生的平滑曲线,上述平滑曲线可以转化成一条方程(比如y=5x+1啥的,也可以写成f(x)=5x+1,但现实世界的情况比较复杂,所以转化出来的方程也比较复杂).

好的，接下来看我表演，我将用我的三寸不烂之舌，把上面这些话给它巧妙地圆回来：

由于连续型随机变量是连续的，所以我们统计的时候，统计的是一个连续的区间，比如身高：1.8m包括了1.8的负极限到1.8的正极限，这其实是一个区间，而非一个单独的数字。

所以，对于连续型随机变量产生的平滑曲线，其实是是一条累计概率曲线，为什么这么说呢?

举个例子，身高1.8m包括了1.8的负极限到1.8的正极限，这其实是一个区间，而非一个单独的数字。所以在连续型随机变量中说1.8这个变量，其实是在说1.8的负极限到1.8的正极限的累计变量。那么，很好理解：身高1.7~1.8，则是1.7到1.8的累计变量，其概率则是累积概率。

总结一下：连续型随机变量产生的平滑曲线其实是一条累积概率曲线。科学家给这条曲线起了个名字，叫概率分布函数，简称**分布函数**，用$F（x）$表示。

科学家为了让问题更加复杂，为了让学生学生难以理解，他们想了一个办法。引入求导和积分的概念，这样就可以让简单的问题复杂化。

他们是这样做的，先对分布函数求导，得到另一个函数，科学家给这个函数起了个名字，叫**概率密度函数**，用$f(x)$。

分布函数与概率密度函数的关系
1. 分布函数求导是概率密度函数
2. 求导的逆过程是求积分
3. 求积分的逆过程是求导
4. 求积分就是求曲线下的面积
所以：
1. 概率密度函数求积分是分布函数
2. 分布函数求导是概率密度函数

换言之：
-  $f(x)\int_{-\infty}^{x}dx=F（x）=P(X\leq x)$也可以这样理解$f(x)\int_{a}^{b}dx=F（a\leq x\leq b）=P(a\leq X\leq b)$
- $F^{`}（x）=f(x)$

再换言之：
- 求概率$P(a\leq X\leq b)$就是求$F（a\leq x\leq b）$
- 求$F（a\leq x\leq b）$就是求$f(x)\int_{-\infty}^{x}dx$，也就是求$f(x)$在$a\leq x\leq b$上的积分，也就是求$f(x)$在$a\leq x\leq b$区间上的曲线下面积。
---
在R语言中，正态分布的分布函数可以使用pnorm函数来表示。pnorm函数的第一个参数是要计算概率的值，第二个参数是正态分布的均值，第三个参数是正态分布的标准差。以下是使用R语言进行正态分布分布函数的示例代码：

```
x <- seq(-4, 4, length.out = 100) # 生成-4到4之间的100个值 

mu <- 0 # 正态分布的均值 

sigma <- 1 # 正态分布的标准差 

y <- pnorm(x, mean = mu, sd = sigma) # 计算正态分布的累积概率 

plot(x, y, type = "l", lwd = 2, xlab = "x", ylab = "F(x)", main = "正态分布的分布函数") # 绘制图像

```

这段代码会生成一个从-4到4的100个值作为x轴，使用pnorm函数计算对应的累积概率作为y轴，然后使用plot函数绘制出正态分布的分布函数图像。 

注意，这只是一个示例代码，你可以根据需要调整参数来绘制不同均值和标准差的正态分布图像。

![[Pasted image 20230724112545.png]]


在R语言中，可以使用函数`pnorm()`来计算正态分布的概率密度函数的曲线下面积，并使用`curve()`函数来绘制相应的图像。 以下是一个例子，计算标准正态分布在区间[-3, 3]内的概率密度函数的曲线下面积，并绘制图像：


```
# 导入ggplot2包用于绘图 
library(ggplot2)  

# 计算标准正态分布在区间[-3, 3]内的概率密度函数曲线下面积 
area <- pnorm(3) - pnorm(-3)  

# 绘制标准正态分布的概率密度函数曲线 
curve(dnorm(x), from = -4, to = 4, xlab = "x", ylab = "概率密度", main = "标准正态分布曲线", col = "blue", lwd = 2)  

# 在图像上绘制面积 
text(0, 0.25, paste("曲线下面积 =", round(area, 4)), pos = 3)  

# 显示图像

```

运行上述代码将会绘制出标准正态分布的概率密度函数曲线，并在图像上显示出曲线下面积的值。你可以根据需要修改区间范围、标签等参数来进行自定义。 

请确保你的R环境中已经安装了`ggplot2`包，如果没有安装，可以通过`install.packages("ggplot2")`命令进行安装。

![[Pasted image 20230724140440.png]]

---

当进行随机抽样是，不同的变量有不同的概率，有的变量概率大，有的变量概率小，用函数表示不同变量的概率大小，即为概率的分布。这里所用的函数就是概率密度函数，而概率密度函数则展示了概率的分布情况。

接下来介绍一种在自然和社会中最常见的一种概率分布，正态分布。正态分布是学习统计学最重要的一种分布，因为其他的分布都可以转化成正态分布。
## 正态分布
正态分布由高斯作为描述误差相对频数分布的模型而提出的：

>   描述连续型随机变量的最重要的分布
>   许多现象都可以由正态分布来描述
>   可用于近似离散型随机变量的分布
>   经典统计推断的基础

正态分布的意义，多多少少大家都有了解，这里就不再详述了。随机变量服从$X∼N(μ,σ^{2})$，则X的概率密度函数为
$$f(x)=2\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2\sigma^{2}}(x-\mu)^{2}},-\infty<x<+\infty$$

这就是正态分布的概率密度函数。正态分布具有如下性质：

-   关于$x=μ$的钟形对称性质，峰值在$x=μ$处。
-   均值和标准差一旦决定，该分布形式也就决定了。
-   均值决定分布函数位置，标准差决定函数的扁平程度。
-   X轴两侧无限延伸，$f(x)$无限逼近x轴,但理论上不可能相交。
-   正态随机变量在特定区间上的取值概率由正态曲线下的面积给出，而且其曲线下的总面积等于1

标准正态分布就是指均值为0，标准差为1的正态分布。通过标准正态分布可以很方便地求算各种概率，所以实际应用中，往往将正态分布数据通过标准化的方式转化为标准正态分布求解具体概率。即令$Z=\frac{x−μ}{σ}$，则$Z$服从标准正态分布。那么如何检验数据的正态性呢？一般有以下几种方法：

-   对数据画出频数分布的直方图或茎叶图（若数据近似服从正态分布， 则图形的形状与上面给出的正态曲线应该相似）。
-   求出样本数据的四分位差和标准差， 然后二者计算比值。 若数据近似服从正态分布，则有$\frac{Q_{d}}{s}≈\frac{1}{3}$

-   拟合优度检验

拟合优度检验是后面章节内容，这里不详述。正态分布在各样本相互前提下存在线性可加性。$x_{i}∼N(μ_{i},σ_{i}^{2})$，且$x_{i}$相互独立，则$\sum{a_{i}x_{i}}∼N(a_{i}μ_{i},a_{i}^{2}σ_{i}^{2})$)。同时样本量够大情况下，n个独立随机变量之和服从正态分布。
### 由正态分布导出来的几个重要分布
#### 抽样分布
近代统计学的创始人之一，英国统计学家费希尔曾把抽样分布、参数估计、假设检验看作统计推断的三个中心内容
#### $\chi^{2}$分布
#### $t$分布
#### $F$分布


##  三种不同性质的分布
### 统计量
统计量(statistic)是样本的一个函数。
样本来自总体，必然携带有反映总体性质的各种信息。统计的基本任务就是通过对样本的研究来对总体的未知参数或分布类型作出估计，对有关总体的假设作出推断。

样本是进行统计推断的依据。但在实际应用时，一般不是直接使用样本本身，而是对样本进行整理和加工, 即针对具体问题构造适当的函数—统计量， 利用这些函数来进行统计推断，揭示总体的统计特性。事实上统计量把分散在样本中的总体信息按需要集中在一个函数上，使该函数能反映总体方面的信息。

讲人话就是：我很懒，我不想去分析总体，因为总体的数量太多，而且分析起来很麻烦，此外，有时候很难获得全部的总体信息，所以我偷个懒，我从总体中抽取一小部分，这一小部分被称为样本，我对这这些样本进行计算，得到一些样本的特征，然后用这些样本特征去推测总体的特征。所以我说，“懒”才是动力。

这里要区分两个概念——统计量与观察值
### 统计量与观察值
假设$X1,X2,⋯,Xn$是来自总体X的样本,$x1,x2,⋯,xn$为其样本值, 则称不含任何总体分布中未知参数的函数$g(X1,X2,⋯,Xn)$为统计量，相应实数$g(x1,x2,⋯,xn)$为观察值。如何理解这二者区别呢？

其实这里把样本看成了一组随机变量，因为在未抽样前，样本观察值未知，样本就是个随机变量（所以一般来说统计推断的基础是简单随机抽样），但是抽样之后，样本就是一组确定的观察值，这也可以说是样本的二重性。常用的统计量包括了样本均值、样本方差、样本标准差、样本k阶原点矩、样本k阶中心距。从前面提到的统计推断基础是简单随机抽样，也就是要求样本是简单随机样本，那么简单随机样本又是什么呢？

首先随机样本的概念：随机抽取的n个个体的集合$(X1,X2,⋯,Xn)$,n为样本容量。而简单随机样本则需要在随机样本的前提上满足以下两个条件：

-   随机性：总体中每个个体都有同等机会被选到样本中,即$X_{i}$与X同分布
-   独立性：样本中每个个体的选取不影响其他个体的选取，即$X1,X2,⋯,Xn$是相互独立的随机变量

接下来是标题提到的三种不同性质的分布：总体分布、样本分布、抽样分布。

-   **总体分布**——==总体中各元素的观察值所形成的分布==，分布通常是未知的，可以假定它服从某种分布。
-   **样本分布**——==一个样本中各观察值的分布==，也称经验分布，当样本容量 n 逐渐增大时，样本分布逐 渐接近总体的分布。
-   **抽样分布**——==样本统计量的概率分布==， 是一种理论分布，又称为诱导分布，在重复选取容量为n 的样本时，由该统计量的所有可能取值形成的相对频数分布，随机变量是样本统计量（样本函数，如样本均值，样本比例，样本方差等），结果来自容量相同的所有可能样本，提供了样本统计量长远而稳定的信息，是进行推断的理论基础，也是抽样推断科学性的重要依据（ 点估计、 置信区间、假设推断等）。
### 总体分布、样本分布、抽样分布的区别
总体分布、样本分布和抽样分布是统计学中常用的概念，它们的区别如下： 
1.  **总体分布**（Population Distribution）：总体分布指的是对一个特定总体的==所有个体或数据==进行的统计分析。例如，我们希望了解全球人口的平均身高，我们需要收集全球各地的个体数据，并对这些数据进行分析来得到总体分布。 
2. **样本分布**（Sample Distribution）：样本分布是==从总体中选取的样本数据在某个特定统计量上的分布情况==。例如，从全球人口中随机选择一小部分人进行调查，得到了调查样本的平均身高数据，那么这些样本的平均身高的分布即为样本分布。 
3. **抽样分布**（Sampling Distribution）：抽样分布是指==从总体中抽取多个样本==，每个样本都有==相同的样本大小==，然后计算每个样本的统计量（例如平均值、标准差等）并构成的分布。例如，从全球人口中不断重复抽取一定数量的个体进行调查，并计算每次抽样所得样本的平均身高，最终得到的这些平均值的分布即为抽样分布。 

举例说明： 
1. 假设我们想要了解一所学校的学生体重分布情况。学校的所有学生构成了总体分布，我们收集所有学生的体重数据并进行统计分析，得到整个学校学生的体重**总体分布**。
2. 从这所学校中随机抽取100名学生，记录他们的体重数据。这100名学生的体重分布即为**样本分布**。 
3. 重复抽取100名学生的样本，并记录每个样本的平均体重。得到的多个样本平均体重值的分布，即为**抽样分布**，通过该分布可以推断关于总体平均体重的统计特征。

以上内容来自 chat GPT

### 样本分布和抽样分布的区别
样本分布和抽样分布是统计学中两个相关但不同的概念。

**样本分布**是指从总体中选择的实际观察样本的频率分布。它表示了从整体中抽取的样本数据的实际观察结果。样本分布通常用于描述和推断总体特征。

**抽样分布**是指通过从总体中选择==多个样本==，然后计算某个统计量（例如均值、方差等）的分布。==它代表了该统计量在不同样本中可能出现的概率分布==。抽样分布用于推断总体参数，并对统计推断进行基础性的理解。

以下是两个示例来说明两者的区别：

1. 假设我们有一个班级的学生身高数据作为总体。我们从总体中随机选择了30名学生的身高数据作为一个样本。这个样本的频率分布即为**样本分布**。而如果我们多次重复采样，每次都计算出样本的平均身高，所有这些平均身高值的分布即为**抽样分布**。

2. 假设我们想了解一款产品的平均用户评分。我们从总体用户中随机选择了100位用户，并记录他们的评分。这个样本的评分分布即为**样本分布**。而如果我们多次重复进行随机抽样，并计算出每个样本的平均评分，所有这些平均评分值的分布即为**抽样分布**。

总之，**样本分布**是从一个特定样本中的观测数据的频率分布，而**抽样分布**是通过多次从总体中抽取样本并计算统计量得到的分布，用于推断总体参数。

以上内容来自 chat GPT

根据总体分布以及样本容量可以将抽样分布分为以下三类：
- 精确抽样分布
- 渐近抽样分布
- 近似抽样分布

### 什么是精确抽样分布，渐近抽样分布，近似抽样分布，它们的区别是什么

-   **精确抽样分布**：当总体分布已知时，如果对任一自然数都能导出统计量分布的显示表达式，这样的抽样分布称为精确抽样分布（对小样本的统计推断特别有用，大多数是在正态总体下得到的， t分布、 F分布等）。
-   **渐近抽样分布**：样本量无限大时统计量的极限分布（大样本问题）。
-   **近似抽样分布**：注意获得近似分布的条件（用统计量的前二阶矩当作正态分布的前二阶矩获得 正态近似，随机模拟法获得统计量的近似分布）。

精确抽样分布、渐近抽样分布和近似抽样分布是统计学中与样本抽样相关的三个重要概念。
#### 精确抽样分布
**精确抽样分布**是概率统计中的一个概念，指的是在给定总体和样本量的情况下，样本统计量的分布。它是基于所有可能的样本组合进行计算的，因此也被称为全面抽样分布。

精确抽样分布在统计推断中非常有用，因为它可以提供对于样本统计量的准确概率分布。这意味着我们可以使用精确抽样分布来计算置信区间、假设检验以及其他统计推断中的概率。

与精确抽样分布相对的是近似抽样分布，近似抽样分布使用一些数值近似方法来估计样本统计量的分布。这些方法可能在样本量较大时更有效，但在样本量较小时，精确抽样分布是更可靠且准确的选择。
- ==例子1==：假设有一个班级的成绩数据，总人数为100名学生。我们需要计算出所有可能的5人样本的平均分布，这将得到一个精确抽样分布。 
- ==例子2==：一批产品的尺寸已知，我们需要计算出随机抽取3个样本的平均尺寸的分布，这也是一个精确抽样分布。
#### 渐近抽样分布
**渐近抽样分布**（Asymptotic Sampling Distribution）是概率论和统计学中的重要概念。它指的是当样本大小逐渐增大时，样本统计量的分布逐渐趋于一个稳定的分布。==换句话说，渐近抽样分布描述了随着样本容量的增加，样本统计量接近总体参数的程度。==

==渐近抽样分布理论的基础是大数定律和中心极限定理。==**大数定律说明当样本容量增大时，样本均值或样本比例等统计量会趋于总体均值或总体比例。而中心极限定理则描述了当样本容量足够大时，样本统计量的分布近似服从正态分布。**

**渐近抽样分布在统计推断和假设检验中起着重要的作用。它允许我们使用样本统计量来做出关于总体参数的推断，并评估推断的可靠性。通过渐近抽样分布，我们可以计算置信区间、进行假设检验以及进行参数估计等统计推断的操作。**

**总之，渐近抽样分布是描述当样本容量增大时样本统计量分布的理论概念，为统计学的推断和假设检验提供了重要的基础。**

- ==例子1==：根据一次大选的投票结果，我们想要得出候选人得票率的置信区间。使用大样本情况下的渐近抽样分布，可以通过正态分布来近似计算。 
- ==例子2==：假设我们研究了某种药物对非常罕见病症的治疗效果，总体中患者数量很少。在这种情况下，我们可以使用大样本的渐近抽样分布来进行统计推断。
#### 近似抽样分布
**近似抽样分布**是指对于一个统计样本的抽样分布进行近似估计的方法。在统计学中，通常我们很难直接计算出一个参数的真实抽样分布，因此可以使用近似抽样分布来近似描述参数的分布情况。

具体而言，通过从总体中抽取多个样本，并计算出每个样本的某个统计量（例如平均值或方差），可以得到一系列的样本统计量。通过对这些样本统计量进行统计分析，可以得到近似抽样分布的特征，如中心极限定理可以用来描述样本均值的近似分布。

**近似抽样分布在统计推断中有广泛的应用，可以用来进行参数估计、假设检验等。常见的近似抽样分布包括t分布、正态分布、卡方分布等，这些分布的特点是在一定条件下可以近似描述样本的统计量分布情况。**

- ==例子1==：对于一个未知总体的平均数的推断，如果总体服从正态分布，我们可以使用t分布来近似抽样分布。 
- ==例子2==：当我们关注总体比例的估计时，可以使用二项分布来近似抽样分布，无论总体分布如何。
#### 它们的区别如下：

1. **精确抽样分布**（Exact Sampling Distribution）：在统计学中，如果我们可以通过穷举所有可能的样本空间来得出准确的统计量分布，那么得到的分布就是精确抽样分布。这种情况下，我们可以确定统计量的期望值和标准差。

2. **渐近抽样分布**（Asymptotic Sampling Distribution）：在实际应用中，样本空间可能非常大，难以穷举所有可能的样本。在这种情况下，我们可以使用渐近理论来近似样本分布。渐近抽样分布是当==样本容量趋于无穷大时==，统计量的分布收敛到一个特定的分布。==最常用的情况是中心极限定理，它表明样本均值在大样本下近似服从正态分布。==

3. **近似抽样分布**（Approximate Sampling Distribution）：当==样本容量较小时==，渐近抽样分布可能不适用。为了估计统计量的分布，我们可以使用一些近似的方法，如基于经验或模拟的方法。近似抽样分布通常是基于一些假设或近似方法得出的结果。

需要注意的是，这些概念在不同的统计问题中有不同的应用和适用条件。在具体问题中，要根据样本容量、抽样方法和统计量等因素来选择合适的抽样方法和相应的分布近似。

以上内容来自 chat GPT

## 4.4 一个总体样本统计量的抽样分布
**样本均值的抽样分布**：在重复选取容量为 n 的样本时，由样本均值的所有可能取值形成的相对频数分布（一种理论概率分布，推断总体均值的理论基础）。

 -   正态总体均值抽样分布——精确分布（均值无偏）。
-   样本均值的中心极限定理——渐进分布。

**中心极限定理**： 设从均值为$μ$， 方差为$σ^{2}$的一个任意总体中抽取容量为n的样本，当n充分大时，样本均值的抽样分布近似服从均值为$μ$、 方差为$\frac{σ^{2}}{n}$的正态分布。

用一张图来说明这个定理（摘自参考书目：贾俊平，《统计学》（第八版），中国人民大学出版社，2022.）。

![[Pasted image 20230724201708.png]]

当然也在这里诞生了一个统计学闻名于世的规定，样本容量n一般至少要求>30。因此样本均值的抽样分布中，样本均值的数学期望（也就是均值）和方差就有对应的公式了。样本均值的数学期望和方差如下。














## 4.5两个总体样本统计量的抽样分布
两个总体样本统计量的抽样分布是指从两个不同总体中抽取两个独立样本，然后计算一些统计量（如均值、方差、相关系数等），并研究这些统计量的分布特征。 

在进行假设检验、置信区间估计或相关分析时，我们经常关注两个总体的差异或关系。为了对这些差异或关系进行推断，我们需要了解这些统计量的分布规律。 

在两个总体样本统计量的抽样分布中，常见的统计量包括差异的均值（差异均值）、比例差异、方差比和相关系数等。

对于每个统计量，可以使用一组抽样方法来生成抽样分布，其中包括重复抽样、独立抽样、无放回抽样等。 

针对每个统计量，可以使用数学方法，如概率分布的变换、大样本近似法、中心极限定理等，来推导出其抽样分布的数学公式或近似公式。

这些分布通常被称为抽样分布或抽样分布族族。 常见的两个总体样本统计量抽样分布包括t分布、F分布和正态分布。

t分布主要用于小样本情况下对两个总体均值差异的推断；F分布主要用于两个总体方差比的推断；正态分布主要用于独立样本的均值差异和相关系数的推断。 

通过分析两个总体样本统计量的抽样分布，可以进行假设检验、置信区间估计和相关分析等推断统计分析，从而帮助我们对两个总体之间的差异或关系进行准确的推断。

在进行两个总体样本统计量抽样分布的推断统计分析时，常见的步骤包括以下几个： 
1. 假设设置：首先，我们需要明确我们想要推断的问题。针对不同的问题，我们需要设定相应的零假设和备择假设。 
2. 抽样方法：根据问题设置，我们需要采用合适的抽样方法来从两个总体中独立地抽取两个样本。通常，我们可以使用随机抽样、系统抽样等方法来保证样本的随机性和代表性。 
3. 统计量计算：在得到两个独立样本后，我们需要计算相应的统计量。这些统计量可以是样本均值、样本标准差、样本比例等，具体取决于我们想要推断的问题。 
4. 抽样分布的推导：接下来，我们需要推导出所关注的两个总体样本统计量的抽样分布的数学公式或近似公式。这可以通过数学推导、概率分布的变换、大样本近似法、中心极限定理等方法来实现。 
5. 寻找临界值：在进行假设检验时，我们需要确定一个临界值，用于判断样本统计量的值是否落在接受或拒绝零假设的范围内。根据抽样分布的性质，可以计算出相应的临界值，或者从统计表中查找。 
6. 推断分析：根据采集的样本数据和抽样分布的知识，我们可以进行假设检验、置信区间估计和相关分析等推断统计分析。例如，对于假设检验，我们可以比较样本统计量与临界值，从而判断是否拒绝零假设。 
7. 结果解释：最后，我们需要对推断结果进行解释并得出结论。这涉及对抽样分布结果的解读，以及对统计推断的合理解释。我们可以得出关于两个总体差异或关系的结论，或者得出对进一步研究的建议。 

以上内容来自 chat GPT








































